{"version":3,"file":"app.bundle.js","mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;UCnSA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;;;;WC5BA;WACA;WACA;WACA;WACA,+BAA+B,wCAAwC;WACvE;WACA;WACA;WACA;WACA,iBAAiB,qBAAqB;WACtC;WACA;WACA,kBAAkB,qBAAqB;WACvC;WACA;WACA,KAAK;WACL;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;;;;WC3BA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;WCNA;WACA;WACA;WACA;WACA;;;;;WCJA;;WAEA;WACA;WACA;WACA;WACA;WACA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,MAAM,qBAAqB;WAC3B;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA;;;;;UEhDA;UACA;UACA;UACA;UACA","sources":["webpack://template-feo-react-babel/./src/AppTypes.ts","webpack://template-feo-react-babel/./src/Controller.ts","webpack://template-feo-react-babel/./src/DurationFunctions.ts","webpack://template-feo-react-babel/./src/EqualityFunctions.ts","webpack://template-feo-react-babel/./src/SocketListenerDelegate.ts","webpack://template-feo-react-babel/./src/appointment-templates/AppointmentTemplateController.ts","webpack://template-feo-react-babel/./src/appointment-templates/AppointmentTemplateDetailModal.ts","webpack://template-feo-react-babel/./src/appointment-templates/AppointmentTemplateFilterView.ts","webpack://template-feo-react-babel/./src/appointment-templates/AppointmentTemplateView.ts","webpack://template-feo-react-babel/./src/appointments/AppointmentBookView.ts","webpack://template-feo-react-babel/./src/appointments/AppointmentController.ts","webpack://template-feo-react-babel/./src/appointments/AppointmentDetailModal.ts","webpack://template-feo-react-babel/./src/appointments/AppointmentFilterView.ts","webpack://template-feo-react-babel/./src/patients/PatientSearchSidebar.ts","webpack://template-feo-react-babel/./src/patients/PatientSearchView.ts","webpack://template-feo-react-babel/./src/App.tsx","webpack://template-feo-react-babel//Users/jimsharples/Development/patient-booking-system/frontend/node_modules/moment/locale|sync|/^\\.\\/.*$/","webpack://template-feo-react-babel/webpack/bootstrap","webpack://template-feo-react-babel/webpack/runtime/chunk loaded","webpack://template-feo-react-babel/webpack/runtime/compat get default export","webpack://template-feo-react-babel/webpack/runtime/define property getters","webpack://template-feo-react-babel/webpack/runtime/hasOwnProperty shorthand","webpack://template-feo-react-babel/webpack/runtime/make namespace object","webpack://template-feo-react-babel/webpack/runtime/node module decorator","webpack://template-feo-react-babel/webpack/runtime/jsonp chunk loading","webpack://template-feo-react-babel/webpack/before-startup","webpack://template-feo-react-babel/webpack/startup","webpack://template-feo-react-babel/webpack/after-startup"],"sourcesContent":["import {SidebarLocation, SidebarPrefs} from \"ui-framework-jps\";\n\n\nexport enum Decorator {\n    Incomplete,\n    Complete,\n    Persisted,\n    PersistedLocally = 3\n}\n\nexport const STATE_NAMES = {\n    users: 'user',\n    chatLogs: 'chatLog',\n    exerciseTypes: 'exerciseType',\n    workouts: 'workout',\n    recentUserSearches: 'recentUserSearch',\n    patientSearch: 'fastSearchNames',\n    recentPatientSearches: 'recentPatientSearches',\n    appointments: 'appointment',\n    appointmentTypes: 'appointmentType',\n    clinicConfig:'clinicConfig',\n    providers:'provider',\n    appointmentTemplates:'appointmentTemplate',\n    patients:'patient'\n}\n\nexport const API_Config = {\n    login: '/login',\n    graphQL: '/graphQL',\n    users: '/api/users',\n    clinicConfig: '/api/clinic-config',\n    patients: '/api/patients',\n    patientDemographics: '/api/demographics'\n};\n\nexport const NAVIGATION = {\n    appointmentBook: 'navigationItemAppointmentBook',\n    patientSearch: 'navigationItemPatientSearch',\n    appointmentTemplates: 'navigationItemAppointmentTemplating',\n    clinicChat: 'navigationItemChat',\n    patientRecords: 'navigationItemPatientRecords',\n    logout: 'navigationItemLogout'\n}\n\nexport const DRAGGABLE = {\n    typeUser: 'user',\n    fromUserSearch: 'userSearch',\n    typePatientSummary:'patientSummary',\n    fromPatientSearch: 'patientSearch'\n}\n\nexport const VIEW_NAME = {\n    blockedUsers: 'blockedUsers',\n    chatLog: 'chatLog',\n    chatLogs: 'chatLogs',\n    favouriteUsers: 'favouriteUsers',\n    userSearch: 'userSearch',\n    patientSearch: 'patientSearch'\n}\n\nexport const VIEW_CONTAINER = {\n    calendarControl: 'calendarControl',\n    calendarDetail:'calendarDetail'\n}\n\n\n\nexport const  PatientSearchSidebarPrefs: SidebarPrefs = {\n    id: 'patientSearchSideBar',\n    expandedSize: '40%',\n    location: SidebarLocation.left\n}\n\nexport const  PatientSearchSidebarContainers = {\n    container: 'recentPatientSearches',\n}\n\nexport const SELECT = {\n    appointmentType : 'event-appt-type',\n    patientSearch : 'event-patient'\n}\n\n","import debug from 'debug';\nimport SocketListenerDelegate from \"./SocketListenerDelegate\";\nimport {API_Config, STATE_NAMES} from \"./AppTypes\";\nimport {v4} from \"uuid\";\nimport {isSameMongo} from \"./EqualityFunctions\";\nimport {\n    AggregateStateManager,\n    AsyncStateManagerWrapper,\n    BasicObjectDefinitionFactory,\n    ChatManager,\n    DataObjectController,\n    DataObjectDefinition,\n    DataObjectListener,\n    DownloadManager, FieldDefinition, FieldType,\n    GraphQLApiStateManager, KeyType,\n    MemoryBufferStateManager,\n    NotificationController, ObjectDefinitionRegistry,\n    RESTApiStateManager,\n    SimpleValueDataSource,\n    SocketManager,\n    StateChangeListener,\n    StateManager\n} from \"ui-framework-jps\";\n\n\nconst cLogger = debug('controller-ts');\nconst cLoggerDetail = debug('controller-ts-detail');\n\nexport default class Controller implements StateChangeListener, DataObjectListener {\n\n\n    private static patientQuery: string = 'query getPatient($identifier: String!){\\n' +\n        '  getPatient(id: $identifier) {\\n' +\n        '    _id,\\n' +\n        '    lastSeen,\\n' +\n        '    lastSeenBy,\\n' +\n        '    dob,\\n' +\n        '    dod,\\n' +\n        '    gender,\\n' +\n        '    ethnicity,\\n' +\n        '    countryofbirth,\\n' +\n        '    created,\\n' +\n        '    modified,\\n' +\n        '    name{\\n' +\n        '      _id,\\n' +\n        '    \\ttitle,\\n' +\n        '    \\tfirstname,\\n' +\n        '    \\tmiddlename,\\n' +\n        '    \\tsurname,\\n' +\n        '    \\taka\\n' +\n        '  \\t},\\n' +\n        '    contact{\\n' +\n        '    \\t_id,\\n' +\n        '    \\tline1,\\n' +\n        '    \\tline2,\\n' +\n        '    \\tsuburb,\\n' +\n        '    \\tpostcode,\\n' +\n        '    \\tstate,\\n' +\n        '    \\tcountry,\\n' +\n        '    \\thome,\\n' +\n        '    \\twork,\\n' +\n        '    \\tmobile,\\n' +\n        '    \\tnokname,\\n' +\n        '    \\tnokphone\\n' +\n        '    },\\n' +\n        '    identifiers {\\n' +\n        '      _id,\\n' +\n        '    \\tmedicare,\\n' +\n        '    \\tmedicareRef,\\n' +\n        '    \\tlegacyId,\\n' +\n        '   \\t \\tdva,\\n' +\n        '   \\t \\tdvaColour,\\n' +\n        '    \\thcc,\\n' +\n        '    \\tihi\\n' +\n        '    },\\n' +\n        '    flags {\\n' +\n        '      _id,\\n' +\n        '    \\tisAcountHolder,\\n' +\n        '    \\tlegacyAccountHolderId,\\n' +\n        '    \\tisDeceased,\\n' +\n        '    \\tisInactive,\\n' +\n        '    \\tshouldSMS,\\n' +\n        '    \\tisMarried,\\n' +\n        '    \\tisCTGRegistered,\\n' +\n        '    \\thasWarnings\\n' +\n        '    },\\n' +\n        '    warnings {\\n' +\n        '      _id, warnings\\n' +\n        '    },\\n' +\n        '    allergies {\\n' +\n        '      _id,\\n' +\n        '    \\tname,\\n' +\n        '    \\treaction,\\n' +\n        '    \\tcreated,\\n' +\n        '    \\tmodified\\n' +\n        '    },\\n' +\n        '    consults {\\n' +\n        '      _id, date, time, doctor, history, diagnosis, plan, findings, created, modified\\n' +\n        '    },\\n' +\n        '    history {\\n' +\n        '      _id, diagnosis, note, isConfidential, date, created, modified\\n' +\n        '    },\\n' +\n        '    results {\\n' +\n        '      _id, lab, labref, test, orderedBy, copies, requested, collected, reported, collectedTime, imported, received, result, isLinked, reviewedBy, isNormal, isLast\\n' +\n        '    },\\n' +\n        '    scripts {\\n' +\n        '      _id, by, name, on, dose, frequency, instructions, repeats, quantity, drugCode, lastPrinted, created, modified\\n' +\n        '    },\\n' +\n        '    scriptHistory {\\n' +\n        '      _id, changed, dose, change, reason, drugCode, name\\n' +\n        '    },\\n' +\n        '    scriptArchive {\\n' +\n        '      _id, medication, dose, scriptNumber, repeats, quantity, approvalCode, drugCode, note, created, modified\\n' +\n        '    },\\n' +\n        '    recalls{\\n' +\n        '      _id, reason, interval, isRecurring, due, isCompleted, created, modified\\n' +\n        '    },\\n' +\n        '    tasks {\\n' +\n        '      _id, by, isUrgent, isCompleted, isRead, title, details, completed, for, created, modified\\n' +\n        '    },\\n' +\n        '    documents {\\n' +\n        '      _id, title, type, from, reviewed, reviewedBy, data, created, modified\\n' +\n        '    },\\n' +\n        '    letters {\\n' +\n        '      _id, creator, isPrinted, isReviewd, from, type, data, to, created, modified\\n' +\n        '    },\\n' +\n        '    vaccinations {\\n' +\n        '      _id, vaccine, on, by, providerNum, batch, expiry, site, shouldSendtoAIR, airCode, created\\n' +\n        '    },\\n' +\n        '    forms {\\n' +\n        '      _id, title, from, category, data, created, modified\\n' +\n        '    },\\n' +\n        '    wcc {\\n' +\n        '      _id,\\n' +\n        '      employer {\\n' +\n        '        name, \\n' +\n        '        contact {\\n' +\n        '          line1, line2, suburb, state, postCode\\n' +\n        '        },\\n' +\n        '        insurer\\n' +\n        '      },\\n' +\n        '      claim {\\n' +\n        '        number, injury, injuryTime, injuryDate, claimDate, mechanism\\n' +\n        '      },\\n' +\n        '      date,time,reviewed, type, diagnosis, comment, treatment, isReturnToNormalDuties, returnToNormalDuties, isRestrictedDuties, restrictedDutiesFrom, restrictedDutiesTo, isNoCapacity, noCapacityFrom, noCapacityTo\\n' +\n        '    },\\n' +\n        '    modifiedDates {\\n' +\n        '      identifiers, warnings, allergies, consults, history, results, scripts, recalls, documents,letters,vaccinations\\n' +\n        '    }\\n' +\n        '  }\\n' +\n        '}'\n\n\n\n\n\n    private static _instance: Controller;\n    protected applicationView: any;\n    protected clientSideStorage: any;\n    protected config: any;\n    // @ts-ignore\n    protected stateManager: StateManager;\n\n    private constructor() {\n    }\n\n    public static getInstance(): Controller {\n        if (!(Controller._instance)) {\n            Controller._instance = new Controller();\n        }\n        return Controller._instance;\n    }\n\n    connectToApplication(applicationView: any, clientSideStorage: any) {\n        this.applicationView = applicationView;\n        this.clientSideStorage = clientSideStorage;\n        // setup the API calls\n        let restSM = RESTApiStateManager.getInstance();\n        restSM.initialise([\n            {\n                stateName: STATE_NAMES.users,\n                serverURL: '',\n                api: API_Config.users,\n                isActive: true\n            },\n            {\n                stateName: STATE_NAMES.clinicConfig,\n                serverURL: '',\n                api: API_Config.clinicConfig,\n                isActive: true\n            },\n            {\n                stateName: STATE_NAMES.patients,\n                serverURL: '',\n                api: API_Config.patientDemographics,\n                isActive: true,\n                idField: '_id'\n            },\n        ]);\n        let qlSM = GraphQLApiStateManager.getInstance();\n        qlSM.initialise([\n            {\n                stateName: STATE_NAMES.patientSearch,\n                serverURL: '',\n                apiURL: API_Config.graphQL,\n                apis: {\n                    findAll: 'query {getPatientSearchDetails {_id,identifiers { legacyId},flags {isInactive,hasWarnings},name {firstname,surname}, warnings {_id, warnings}}}',\n                    create: '',\n                    destroy: '',\n                    update: '',\n                    find: '',\n                },\n                data: {\n                    findAll: 'getPatientSearchDetails',\n                    create: '',\n                    destroy: '',\n                    update: '',\n                    find: ''\n                },\n                isActive: true,\n                idField: '_id'\n            },\n            {\n                stateName: STATE_NAMES.appointments,\n                serverURL: '',\n                apiURL: API_Config.graphQL,\n                apis: {\n                    findAll: 'query {getAppointments {_id,_patient, start, time, duration,createdBy,isDNA,isCancelled,provider,note,type,name,created,modified,arrivalTime,readyForBilling,isBilled,billingItems}}',\n                    create: 'mutation createAppointment($data: AppointmentInput!){addAppointment(appt: $data) {_id,_patient, start, time, duration,createdBy,isDNA,isCancelled,provider,note,type,name,created,modified,arrivalTime,readyForBilling,isBilled,billingItems}}',\n                    destroy: 'mutation deleteAppointment($identifier: String!){deleteAppointment(id: $identifier)}',\n                    update: 'mutation updateAppointment($data: AppointmentInput!){updateAppointment(appt: $data)}',\n                    find: '',\n                },\n                data: {\n                    findAll: 'getAppointments',\n                    create: 'addAppointment',\n                    destroy: 'deleteAppointment',\n                    update: 'updateAppointment',\n                    find: ''\n                },\n                isActive: true,\n                idField: '_id'\n            },\n            {\n                stateName: STATE_NAMES.appointmentTypes,\n                serverURL: '',\n                apiURL: API_Config.graphQL,\n                apis: {\n                    findAll: 'query {getAppointmentTypes {_id,name,colour,icon}}',\n                    create: 'mutation createAppointmentType($data: AppointmentInput!){addAppointmentType(apptType: $data) {_id,name,colour,icon}}',\n                    destroy: 'mutation deleteAppointmentType($identifier: String!){deleteAppointmentType(id: $identifier)}',\n                    update: 'mutation updateAppointmentType($data: AppointmentInput!){updateAppointmentType(apptType: $data)}',\n                    find: '',\n                },\n                data: {\n                    findAll: 'getAppointmentTypes',\n                    create: 'addAppointmentType',\n                    destroy: 'deleteAppointmentType',\n                    update: 'updateAppointmentType',\n                    find: ''\n                },\n                isActive: true,\n                idField: '_id'\n            },\n            {\n                stateName: STATE_NAMES.providers,\n                serverURL: '',\n                apiURL: API_Config.graphQL,\n                apis: {\n                    findAll: 'query {getProviders {_id,name,providerNo,isCurrent}}',\n                    create: 'mutation addProvider($data: ProviderInput!){addProvider(provider: $data) {_id,name,providerNo,isCurrent}}',\n                    destroy: 'mutation deleteProvider($identifier: String!){deleteProvider(id: $identifier)}',\n                    update: 'mutation updateProvider($data: ProviderInput!){updateProvider(provider: $data)}',\n                    find: '',\n                },\n                data: {\n                    findAll: 'getProviders',\n                    create: 'addProvider',\n                    destroy: 'deleteProvider',\n                    update: 'updateProvider',\n                    find: ''\n                },\n                isActive: true,\n                idField: '_id'\n            },\n            {\n                stateName: STATE_NAMES.appointmentTemplates,\n                serverURL: '',\n                apiURL: API_Config.graphQL,\n                apis: {\n                    findAll: 'query {getAppointmentTemplates {_id,day, time, duration,createdBy,provider,type,created,modified}}',\n                    create: 'mutation addAppointmentTemplate($data: AppointmentTemplateInput!){addAppointmentTemplate(template: $data) {_id,day, time, duration,createdBy,provider,type,created,modified}}',\n                    destroy: 'mutation deleteAppointmentTemplate($identifier: String!){deleteAppointmentTemplate(id: $identifier)}',\n                    update: 'mutation updateAppointmentTemplate($data: AppointmentTemplateInput!){updateAppointmentTemplate(template: $data)}',\n                    find: '',\n                },\n                data: {\n                    findAll: 'getAppointmentTemplates',\n                    create: 'addAppointmentTemplate',\n                    destroy: 'deleteAppointmentTemplate',\n                    update: 'updateAppointmentTemplate',\n                    find: ''\n                },\n                isActive: true,\n                idField: '_id'\n            },\n            {\n                stateName: STATE_NAMES.patients,\n                serverURL: '',\n                apiURL: API_Config.graphQL,\n                apis: {\n                    findAll: '',\n                    create: '',\n                    destroy: '',\n                    update: '',\n                    find: Controller.patientQuery,\n                },\n                data: {\n                    findAll: '',\n                    create: '',\n                    destroy: '',\n                    update: '',\n                    find: ''\n                },\n                isActive: true,\n                idField: '_id'\n            },\n        ])\n\n\n        let aggregateSM = new AggregateStateManager(isSameMongo);\n        let memorySM = new MemoryBufferStateManager(isSameMongo);\n\n        let asyncREST = new AsyncStateManagerWrapper(aggregateSM, restSM, isSameMongo);\n        let asyncQL = new AsyncStateManagerWrapper(aggregateSM, qlSM, isSameMongo);\n\n        aggregateSM.addStateManager(memorySM, [], false);\n        aggregateSM.addStateManager(asyncREST, [STATE_NAMES.recentUserSearches, STATE_NAMES.appointments,STATE_NAMES.patientSearch,STATE_NAMES.recentPatientSearches,STATE_NAMES.appointmentTypes, STATE_NAMES.providers,STATE_NAMES.appointmentTemplates,STATE_NAMES.patients], false);\n        //aggregateSM.addStateManager(asyncREST, [STATE_NAMES.recentUserSearches, STATE_NAMES.appointments,STATE_NAMES.patientSearch,STATE_NAMES.recentPatientSearches,STATE_NAMES.appointmentTypes, STATE_NAMES.providers,STATE_NAMES.appointmentTemplates], false);\n        aggregateSM.addStateManager(asyncQL, [STATE_NAMES.recentUserSearches, STATE_NAMES.users,STATE_NAMES.clinicConfig], false);\n        //aggregateSM.addStateManager(asyncQL, [STATE_NAMES.recentUserSearches, STATE_NAMES.users,STATE_NAMES.clinicConfig,STATE_NAMES.patientDemographics], false);\n        this.stateManager = aggregateSM;\n\n        // state listener\n        this.stateChanged = this.stateChanged.bind(this);\n        this.stateChangedItemAdded = this.stateChangedItemAdded.bind(this);\n        this.stateChangedItemRemoved = this.stateChangedItemRemoved.bind(this);\n        this.stateChangedItemUpdated = this.stateChangedItemUpdated.bind(this);\n\n        // data objects\n        this.setupDataObjectDefinitions();\n\n        return this;\n    }\n\n    /*\n        Get the base data for the application (users, entries)\n    */\n    public onDocumentLoaded(): void {\n        cLogger('Initialising data state');\n        // listen for socket events\n        let socketListerDelegate = new SocketListenerDelegate();\n        SocketManager.getInstance().setListener(socketListerDelegate);\n\n        // now that we have all the user we can setup the chat system but only if we are logged in\n        cLogger(`Setting up chat system for user ${this.getLoggedInUserId()}: ${this.getLoggedInUsername()}`);\n        if (this.getLoggedInUserId().trim().length > 0) {\n            // setup the chat system\n            let chatManager = ChatManager.getInstance(); // this connects the manager to the socket system\n\n            // setup the chat notification system\n            NotificationController.getInstance();\n            chatManager.setCurrentUser(this.getLoggedInUsername());\n\n            // let the application view know about message counts\n            chatManager.setUnreadCountListener(this.applicationView);\n\n            chatManager.login();\n\n            // load the users\n            this.getStateManager().getStateByName(STATE_NAMES.users);\n            this.getStateManager().getStateByName(STATE_NAMES.appointmentTypes);\n            this.getStateManager().getStateByName(STATE_NAMES.providers);\n            this.getStateManager().getStateByName(STATE_NAMES.appointmentTemplates);\n            this.getStateManager().getStateByName(STATE_NAMES.clinicConfig);\n            this.getStateManager().getStateByName(STATE_NAMES.patientSearch);\n            this.getStateManager().getStateByName(STATE_NAMES.appointments);\n\n            // apply any queued changes from being offline\n            DownloadManager.getInstance().processOfflineItems();\n        }\n\n    }\n\n    public getStateManager(): StateManager {\n        return this.stateManager;\n    }\n\n    public getListenerName(): string {\n        return 'Controller';\n    }\n\n    public isLoggedIn(): boolean {\n        let isLoggedIn = false;\n        try {\n            // @ts-ignore\n            if (loggedInUser) {\n                isLoggedIn = true;\n            }\n        } catch (error) {\n        }\n        return isLoggedIn;\n    }\n\n    public getLoggedInUserId(): string {\n        let result = '';\n        try {\n            // @ts-ignore\n            if (loggedInUser) {\n                // @ts-ignore\n                result = loggedInUser._id;\n            }\n        } catch (error) {\n        }\n        cLoggerDetail(`Logged in user id is ${result}`);\n        return result;\n    }\n\n    public getLoggedInUsername(): string {\n        let result = '';\n        try {\n            // @ts-ignore\n            if (loggedInUser) {\n                // @ts-ignore\n                result = loggedInUser.username;\n            }\n        } catch (error) {\n        }\n        cLoggerDetail(`Logged in user is ${result}`);\n        return result;\n    }\n\n    public handleMessage(message: string): void {\n        cLogger(message);\n    }\n\n    public getCurrentUser(): string {\n        return this.getLoggedInUserId();\n    }\n\n    stateChangedItemAdded(managerName: string, name: string, itemAdded: any): void {\n    }\n\n    stateChangedItemRemoved(managerName: string, name: string, itemRemoved: any): void {\n    }\n\n    stateChangedItemUpdated(managerName: string, name: string, itemUpdated: any, itemNewValue: any): void {\n    }\n\n    stateChanged(managerName: string, name: string, values: any) {\n    }\n\n    handleShowChat(roomName: string | null) {\n        this.applicationView.handleShowChat(roomName);\n    }\n\n    create(controller: DataObjectController, typeName: string, dataObj: any): void {\n        switch (typeName) {\n            case STATE_NAMES.exerciseTypes: {\n                cLogger(`Handling create new exercise type`);\n                cLoggerDetail(dataObj);\n                this.stateManager.addNewItemToState(typeName, dataObj, false);\n                break;\n            }\n        }\n    }\n\n    delete(controller: DataObjectController, typeName: string, dataObj: any): void {\n        switch (typeName) {\n            case STATE_NAMES.exerciseTypes: {\n                cLogger(`Handling delete exercise type - already managed by stateful collection view`);\n                cLoggerDetail(dataObj);\n                break;\n            }\n        }\n    }\n\n    update(controller: DataObjectController, typeName: string, dataObj: any): void {\n        switch (typeName) {\n            case STATE_NAMES.exerciseTypes: {\n                cLogger(`Handling update exercise type`);\n                cLoggerDetail(dataObj);\n                this.stateManager.updateItemInState(typeName, dataObj, false);\n                break;\n            }\n        }\n    }\n\n    addExerciseToCurrentWorkout(exerciseType: any): void {\n        let copyOfExercise = {...exerciseType};\n        copyOfExercise._id = v4(); // update the id to be unique for the workout\n        this.applicationView.addingExerciseToCurrentWorkout(copyOfExercise);\n    }\n\n    addWorkoutExercisesToCurrentWorkout(workout: any): void {\n        if (workout.exercises) {\n            workout.exercises.forEach((exercise: any) => {\n                this.addExerciseToCurrentWorkout(exercise);\n            });\n        }\n    }\n\n    private setupDataObjectDefinitions() {\n        // create the object definitions for the exercise type and workout\n        let exerciseTypeDefinition: DataObjectDefinition = ObjectDefinitionRegistry.getInstance().addDefinition(STATE_NAMES.exerciseTypes, 'Exercise', true, true, true, '_id');\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(exerciseTypeDefinition, \"name\", \"Name\", FieldType.text, true, \"Exercise name\");\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(exerciseTypeDefinition, \"type\", \"Type\", FieldType.limitedChoice, true, \"Choose cardio or strength\",\n            new SimpleValueDataSource([\n                {name: 'Cardio', value: 'cardio'},\n                {name: 'Strength', value: 'strength'}\n            ]));\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(exerciseTypeDefinition, \"duration\", \"Duration\", FieldType.duration, true, \"Exercise time\");\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(exerciseTypeDefinition, \"sets\", \"Sets\", FieldType.integer, false, \"Number of sets\");\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(exerciseTypeDefinition, \"reps\", \"Repetitions\", FieldType.integer, false, \"Number of reps\");\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(exerciseTypeDefinition, \"weight\", \"Weight\", FieldType.float, false, \"Weight used\");\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(exerciseTypeDefinition, \"distance\", \"Distance\", FieldType.float, false, \"Distance travelled\");\n\n        cLogger(`Exercise type data object definition`);\n        cLogger(exerciseTypeDefinition);\n        cLoggerDetail(ObjectDefinitionRegistry.getInstance().findDefinition('exerciseType'));\n\n        let workoutDefinition: DataObjectDefinition = ObjectDefinitionRegistry.getInstance().addDefinition(STATE_NAMES.workouts, 'Workout', true, true, true, '_id');\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(workoutDefinition, \"name\", \"Name\", FieldType.text, false, \"Give the workout a name\");\n        BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(workoutDefinition, \"completed\", \"Completed\", FieldType.boolean, true, \"Have completed the workout\");\n        let exercisesFieldDefinition: FieldDefinition = BasicObjectDefinitionFactory.getInstance().addStringFieldToObjDefinition(workoutDefinition, \"exercises\", \"Exercises\", FieldType.collection, true, \"Exercises in this workout\");\n        exercisesFieldDefinition.idType = KeyType.collection;\n        exercisesFieldDefinition.collectionOfDataObjectId = exerciseTypeDefinition.id;\n\n        cLogger(`Workout data object definition`);\n        cLogger(workoutDefinition);\n        cLoggerDetail(ObjectDefinitionRegistry.getInstance().findDefinition('workout'));\n\n\n    }\n\n    /*\n    *\n    * Simple Application state (URL, logged in user)\n    *\n     */\n    private getServerAPIURL(): string {\n        let result = \"\";\n        // @ts-ignore\n        if ((window.ENV) && (window.ENV.serverURL)) {\n            // @ts-ignore\n            result = window.ENV.serverURL;\n        }\n        return result;\n    }\n\n    filterResults(managerName: string, name: string, filterResults: any): void {\n    }\n\n}\n\n\n","export function addDurations(duration1: string, duration2: string): string {\n    const durationRegexp: RegExp = /^(\\d+:)?[0-5]?\\d:[0-5]\\d$/;\n\n    // check both are valid durations\n    const duration1Valid: boolean = durationRegexp.test(duration1);\n    const duration2Valid: boolean = durationRegexp.test(duration2);\n\n    if (duration1Valid && duration2Valid) {\n\n        // split them into seconds, minutes, and hours\n        const duration1Components: string[] = duration1.split(':');\n        const duration2Components: string[] = duration2.split(':');\n\n\n        let carry = 0;\n        // add the seconds (last elements in each)\n        const duration1Seconds = parseInt(duration1Components[duration1Components.length - 1]);\n        const duration2Seconds = parseInt(duration2Components[duration2Components.length - 1]);\n\n\n        let sumSeconds = duration1Seconds + duration2Seconds;\n        if (sumSeconds >= 60) {\n            carry = 1;\n            sumSeconds -= 60;\n        }\n\n        const duration1Minutes = parseInt(duration1Components[duration1Components.length - 2]);\n        const duration2Minutes = parseInt(duration2Components[duration2Components.length - 2]);\n\n        let sumMinutes = duration1Minutes + duration2Minutes + carry;\n        if (sumMinutes >= 60) {\n            carry = 1;\n            sumMinutes -= 60;\n        }\n\n        // do we have hours?\n        let duration1Hours = 0;\n        if (duration1Components.length == 3) {\n            duration1Hours = parseInt(duration1Components[0]);\n        }\n        let duration2Hours = 0;\n        if (duration2Components.length == 3) {\n            duration2Hours = parseInt(duration2Components[0]);\n        }\n\n\n        let sumHours = duration1Hours + duration2Hours + carry;\n\n        return `${(sumHours > 0) ? sumHours + ':' : ''}${(sumMinutes < 10) ? '0' + sumMinutes : sumMinutes}:${(sumSeconds < 10) ? '0' + sumSeconds : sumSeconds}`\n    } else {\n        return '00:00';\n    }\n}\n\nexport function computeTimeStringFromStartTimeAndDurationInSeconds(appointmentTime:string, duration:number):string{\n    const time = parseInt(appointmentTime); // HHMMSS as a time\n\n\n    const startTimeHours = Math.floor(time / 10000);\n    const startTimeMinutes = Math.floor((time - (startTimeHours * 10000)) / 100);\n    const appointmentDuration = Math.floor(duration / 60);\n\n    let endTimeHours = startTimeHours;\n    let endTimeMinutes = startTimeMinutes + appointmentDuration;\n\n    if (endTimeMinutes >= 60) {\n        endTimeMinutes -= 60;\n        endTimeHours += 1; // 24 hour time\n    }\n\n    let timeString = `${endTimeHours}`;\n    if (endTimeHours < 10) timeString = '0' + timeString;\n    if (endTimeMinutes < 10) timeString += '0';\n    timeString += `${endTimeMinutes}`;\n    return timeString;\n}","\n\nexport function isSame(item1: any, item2: any): boolean {\n    return (item1.id === item2.id);\n}\n\nexport function isSameMongo(item1: any, item2: any): boolean {\n    return (item1._id === item2._id);\n}\n\n\nexport function isSameUsername(item1: any, item2: any): boolean {\n    return (item1.username === item2.username);\n}\n\nexport function isSameRoom(item1: any, item2: any): boolean {\n    return (item1.roomName === item2.roomName);\n}\n","\n\nimport debug from 'debug';\n\n\nimport Controller from \"./Controller\";\n\nimport {STATE_NAMES} from \"./AppTypes\";\nimport {DataChangeType, NotificationManager, NotificationType, SecurityManager, SocketListener} from \"ui-framework-jps\";\n\nconst slLogger = debug('socket-listener');\n\nexport default class SocketListenerDelegate implements SocketListener {\n\n    public constructor() {\n    }\n\n    public handleDataChangedByAnotherUser(message: any) {\n        slLogger(`Handling data change ${message.type} on object type ${message.stateName} made by user ${message.user}`);\n        let stateObj = message.data;\n        slLogger(stateObj);\n\n        // are we the same user that made the changes?\n        if (message.user === SecurityManager.getInstance().getLoggedInUsername()) {\n            slLogger(`changes made by the current user, no need to do anything`);\n        }\n        // ok lets work out where this change belongs\n        try {\n            switch (message.type) {\n                case DataChangeType.create: {\n                    switch (message.stateName) {\n                        case STATE_NAMES.users: {\n                            Controller.getInstance().getStateManager().addNewItemToState(STATE_NAMES.users, stateObj, true);\n                            NotificationManager.getInstance().show(stateObj.username, `${stateObj.username} has just registered.`, NotificationType.info);\n                            break;\n                        }\n                        case STATE_NAMES.appointments: {\n                            Controller.getInstance().getStateManager().addNewItemToState(STATE_NAMES.appointments, stateObj, true);\n                            break;\n                        }\n                        case STATE_NAMES.appointmentTypes: {\n                            Controller.getInstance().getStateManager().addNewItemToState(STATE_NAMES.appointmentTypes, stateObj, true);\n                            break;\n                        }\n                    }\n                    break;\n                }\n                case DataChangeType.update: {\n                    switch (message.stateName) {\n                        case STATE_NAMES.appointmentTypes: {\n                            Controller.getInstance().getStateManager().updateItemInState(STATE_NAMES.appointmentTypes, stateObj, true);\n                            break;\n                        }\n                        case STATE_NAMES.appointments: {\n\n                            Controller.getInstance().getStateManager().updateItemInState(STATE_NAMES.appointments, stateObj, true);\n                            break;\n                        }\n                    }\n                    break;\n                }\n                case DataChangeType.delete: {\n                    switch (message.stateName) {\n                        case STATE_NAMES.appointmentTypes: {\n                            Controller.getInstance().getStateManager().removeItemFromState(STATE_NAMES.appointmentTypes, stateObj, true);\n                            break;\n                        }\n                        case STATE_NAMES.appointments: {\n                            Controller.getInstance().getStateManager().removeItemFromState(STATE_NAMES.appointments, stateObj, true);\n                            break;\n                        }\n                    }\n                    break;\n                }\n            }\n        } catch (err) {\n            slLogger(err);\n        }\n\n    }\n\n    handleMessage(message: string): void {\n        slLogger(`Received message: ${message}`);\n    }\n\n    getCurrentUser(): string {\n        return Controller.getInstance().getLoggedInUserId();\n    }\n\n}\n","import debug from \"debug\";\nimport moment from \"moment\";\nimport {STATE_NAMES} from \"../AppTypes\";\nimport Controller from \"../Controller\";\nimport {SecurityManager, StateChangeListener} from \"ui-framework-jps\";\n\nimport {AppointmentTemplateView} from \"./AppointmentTemplateView\";\nimport {AppointmentTemplateFilterView} from \"./AppointmentTemplateFilterView\";\nimport {AppointmentTemplateDetailModal} from \"./AppointmentTemplateDetailModal\";\nimport {computeTimeStringFromStartTimeAndDurationInSeconds} from \"../DurationFunctions\";\n\n\nconst logger = debug('appointment-template-controller');\n\n\ntype AppointmentTemplateDataElements = {\n    appointmentTypes: any[] | null,\n    clinicConfig: any | null,\n    providers: any[] | null,\n    oldEvent: any | null,\n    tempEvent: any,\n    currentFirstDate:number,\n    currentFirstDateDayNumber:number,\n    currentLastDate:number\n}\n\nexport class AppointmentTemplateController implements StateChangeListener {\n    private static _instance: AppointmentTemplateController;\n\n    public static getInstance(): AppointmentTemplateController {\n        if (!(AppointmentTemplateController._instance)) {\n            AppointmentTemplateController._instance = new AppointmentTemplateController();\n        }\n        return AppointmentTemplateController._instance;\n    }\n\n\n\n    private dataElements: AppointmentTemplateDataElements = {\n        appointmentTypes: null,\n        clinicConfig: null,\n        providers: null,\n        oldEvent: null,\n        tempEvent: {},\n        currentFirstDate:0,\n        currentLastDate:0,\n        currentFirstDateDayNumber:1\n    };\n\n    public getModel(): AppointmentTemplateDataElements {\n        return this.dataElements;\n    }\n\n    public onDocumentLoaded() {\n        AppointmentTemplateView.getInstance().onDocumentLoaded();\n        AppointmentTemplateFilterView.getInstance().onDocumentLoaded();\n    }\n\n\n    private constructor() {\n        this.onPageLoading = this.onPageLoading.bind(this);\n\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.clinicConfig, this);\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.appointmentTypes, this);\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.providers, this);\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.appointmentTemplates, this);\n\n    }\n\n    public getIconForAppointmentType(appointmentType: string) {\n        logger(`Getting icon for appoint type ${appointmentType}`);\n        let result = ``;\n        if (this.dataElements.appointmentTypes) {\n            let foundIndex = this.dataElements.appointmentTypes.findIndex((type) => type.name === appointmentType);\n            if (foundIndex >= 0) {\n                if (this.dataElements.appointmentTypes[foundIndex].icon) {\n                    result = `<i class=\"md-custom-event-icon ${this.dataElements.appointmentTypes[foundIndex].icon}\"></i>`;\n                }\n\n            }\n        }\n        return result;\n    }\n\n\n    public getIconsForEventTemplate(event: any): string {\n        return this.getIconForAppointmentType(event.type);\n    }\n\n    public getColourForAppointmentType(appointmentType: string) {\n        let result = `rgba(10, 100, 100, 50)`;\n        if (this.dataElements.appointmentTypes) {\n            let foundIndex = this.dataElements.appointmentTypes.findIndex((type) => type.name === appointmentType);\n            if (foundIndex >= 0) result = this.dataElements.appointmentTypes[foundIndex].colour;\n        }\n        return result;\n    }\n\n    public getColourForAppointmentTemplate(appointment: any) {\n        return this.getColourForAppointmentType(appointment.type);;\n    }\n\n    public getEventForAppointmentTemplateForDate(startDate:number, dayNumber:number, template:any):any {\n        logger(`Creating event for appointment template on date ${startDate} with ${dayNumber}`);\n        logger(template);\n        if (template.day < dayNumber) return null;\n        const loadDate = startDate + (template.day - dayNumber);\n\n        const timeString = computeTimeStringFromStartTimeAndDurationInSeconds(template.time,template.duration);\n\n\n        let result = {\n            id: template._id,\n            start: moment(`${startDate}${template.time}`, 'YYYYMMDDHHmmss'),\n            end: moment(`${startDate}${timeString}`, 'YYYYMMDDHHmm'),\n            color: this.getColourForAppointmentTemplate(template),\n            allDay: false,\n            editable: true,\n            resource: template.provider,\n            createdBy: template.createdBy,\n            created: template.created,\n            modified: template.modified,\n            type: template.type,\n            provider: template.provider\n        }\n        logger('Converted to event');\n        logger(result);\n\n        return result;\n\n    }\n\n\n    public getEventForAppointmentTemplate(template:any):any {\n        logger(`Creating event for appointment template with first day number of ${this.dataElements.currentFirstDateDayNumber}`);\n        logger(template);\n        if (template.day < this.dataElements.currentFirstDateDayNumber) return null;\n        const loadDate = this.dataElements.currentFirstDate + (template.day - this.dataElements.currentFirstDateDayNumber);\n\n\n\n        let result = this.getEventForAppointmentTemplateForDate(loadDate,template.day,template);\n        logger('Converted to template event');\n        logger(result);\n\n        return result;\n\n    }\n\n\n    public onPageLoading(event: any, inst: any): void {  // load the events for the view\n        logger(event);\n        this.dataElements.currentFirstDate = parseInt(moment(event.firstDay).format('YYYYMMDD'));\n        this.dataElements.currentFirstDateDayNumber = parseInt(moment(event.firstDay).format('d'));\n        this.dataElements.currentLastDate = parseInt(moment(event.lastDay).format('YYYYMMDD')) - 1;\n        logger(`Need to load date range (${this.dataElements.currentFirstDate},${this.dataElements.currentLastDate }) starting with day ${this.dataElements.currentFirstDateDayNumber}`);\n\n\n        const appointments = Controller.getInstance().getStateManager().getStateByName(STATE_NAMES.appointmentTemplates);\n        let results: any[] = [];\n        appointments.forEach((appointment: any) => {\n            let result = this.getEventForAppointmentTemplate(appointment);\n            if (result) results.push(result);\n        });\n\n        inst.setEvents(results);\n    }\n\n    filterResults(managerName: string, name: string, filterResults: any): void {\n    }\n\n    getListenerName(): string {\n        return \"Appointment Template Manager\";\n    }\n\n    stateChanged(managerName: string, name: string, newValue: any): void {\n        logger(`Handling state changed ${name}`);\n\n        switch (name) {\n            case STATE_NAMES.clinicConfig: {\n                this.dataElements.clinicConfig = newValue[0];\n                AppointmentTemplateView.getInstance().applyClinicConfig(this.dataElements.clinicConfig);\n                break;\n            }\n            case (STATE_NAMES.appointmentTypes): {\n                this.dataElements.appointmentTypes = newValue;\n                AppointmentTemplateDetailModal.getInstance().setupAppointmentTypeDropDown(newValue);\n                break;\n\n            }\n            case (STATE_NAMES.providers): {\n                this.dataElements.providers = newValue;\n\n                AppointmentTemplateFilterView.getInstance().populateProviders(newValue);\n\n                AppointmentTemplateView.getInstance().setupProviders(newValue);\n\n                break;\n\n            }\n            case (STATE_NAMES.appointmentTemplates): {\n                const appointments = Controller.getInstance().getStateManager().getStateByName(STATE_NAMES.appointmentTemplates);\n                let results: any[] = [];\n                appointments.forEach((appointment: any) => {\n                    let result = this.getEventForAppointmentTemplate(appointment);\n                    if (result) results.push(result);\n                });\n\n                AppointmentTemplateView.getInstance().getCalender().setEvents(results);\n\n                break;\n\n            }\n\n        }\n    }\n\n    stateChangedItemAdded(managerName: string, name: string, appointment: any): void {\n        if ((name === STATE_NAMES.appointmentTemplates) && (appointment.createdBy !== SecurityManager.getInstance().getLoggedInUsername())) {\n            logger('New Appointment Template inserted by another user');\n            logger(appointment);\n\n            let result = this.getEventForAppointmentTemplate(appointment);\n            if (result) AppointmentTemplateView.getInstance().getCalender().addEvent(result);\n        }\n    }\n\n    stateChangedItemRemoved(managerName: string, name: string, appointment: any): void {\n        if (name === STATE_NAMES.appointmentTemplates) {\n            logger('Appointment Template deleted by another user');\n            logger(appointment);\n\n            AppointmentTemplateView.getInstance().getCalender().removeEvent([appointment._id]);\n        }\n    }\n\n    stateChangedItemUpdated(managerName: string, name: string, itemUpdated: any, appointment: any): void {\n        if ((name === STATE_NAMES.appointmentTemplates) && (appointment.createdBy !== SecurityManager.getInstance().getLoggedInUsername())) {\n            logger('Appointment updated by another user');\n            logger(appointment);\n\n            let result = this.getEventForAppointmentTemplate(appointment);\n            if (result) AppointmentTemplateView.getInstance().getCalender().updateEvent(result);\n        }\n    }\n\n    public getAppointmentTemplateFromEvent(event: any): any {\n        let day = parseInt(moment(event.start).format('d'));\n        let time = moment(event.start).format('HHmmss');\n        let duration = moment(event.end).diff(moment(event.start), 'seconds');\n\n\n        let appointment = {\n            _id: event.id,\n            day: day,\n            time: time,\n            duration: duration,\n            createdBy: event.createdBy,\n            created: event.created,\n            modified: event.modified,\n            type: event.type,\n            provider: event.resource\n        };\n        return appointment;\n    }\n\n\n}\n","import {SELECT, STATE_NAMES} from \"../AppTypes\";\nimport {datepicker, getInst, Popup, popup, select, snackbar} from \"@mobiscroll/javascript\";\nimport {AppointmentTemplateController} from \"./AppointmentTemplateController\";\nimport Controller from \"../Controller\";\nimport moment from \"moment\";\nimport {AppointmentTemplateView} from \"./AppointmentTemplateView\";\nimport {v4} from \"uuid\";\nimport {SecurityManager} from \"ui-framework-jps\";\nimport debug from \"debug\";\n\nconst logger = debug('appointment-template-detail-view');\n\ntype AppointmentTemplateDetailViewElements = {\n    popup: Popup | null,\n    range: any | null,\n    deleteButton: HTMLButtonElement | null,\n    appointmentTypeEl: HTMLSelectElement | null,\n    appointmentTypeDropdown: any | null,\n    providersDropdown: any | null,\n}\n\n\nexport class AppointmentTemplateDetailModal {\n\n    private static _instance: AppointmentTemplateDetailModal;\n\n    public static getInstance(): AppointmentTemplateDetailModal {\n        if (!(AppointmentTemplateDetailModal._instance)) {\n            AppointmentTemplateDetailModal._instance = new AppointmentTemplateDetailModal();\n        }\n        return AppointmentTemplateDetailModal._instance;\n    }\n\n\n    private static datePickerResponsive = {\n        medium: {\n            controls: ['calendar'],\n            touchUi: false\n        }\n    }\n    private static datetimePickerResponsive = {\n        medium: {\n            controls: ['calendar', 'time'],\n            touchUi: false\n        }\n    }\n\n    private patients: any[];\n\n    private constructor() {\n        this.patients = [];\n    }\n\n    private viewElements: AppointmentTemplateDetailViewElements = {\n        popup: null,\n        range: null,\n        deleteButton: null,\n        appointmentTypeEl: null,\n        appointmentTypeDropdown: null,\n        providersDropdown: null\n    }\n\n    public close() {\n        this.viewElements.popup.close();\n    }\n\n    public isVisible() {\n        return this.viewElements.popup.isVisible();\n    }\n\n    public applyClinicConfig(clinicConfig: any) {\n        this.viewElements.range.setOptions({\n            stepMinute: clinicConfig.dragTimeStep\n        });\n\n    }\n\n\n    public onDocumentLoaded() {\n\n        this.viewElements.deleteButton = <HTMLButtonElement>document.getElementById('event-delete-template');\n        this.viewElements.appointmentTypeEl = <HTMLSelectElement>document.getElementById('event-appt-type-template');\n\n        \n        // @ts-ignore\n        this.viewElements.popup = popup('#add-appointment-template-popup', {\n            display: 'bottom',\n            contentPadding: true,\n            fullScreen: true,\n            responsive: {\n                medium: {\n                    display: 'anchored',\n                    width: 400,\n                    fullScreen: false,\n                    touchUi: false\n                }\n            }\n        });\n\n\n        this.viewElements.range = datepicker('#event-date-template', {\n            controls: ['date'],\n            select: 'range',\n            startInput: '#start-input-template',\n            endInput: '#end-input-template',\n            showRangeLabels: false,\n            touchUi: true,\n            stepMinute: 15,\n            maxTime: '17:00',\n            responsive: AppointmentTemplateDetailModal.datePickerResponsive,\n            onChange: function (args: any) {\n                let date = args.value;\n                // update event's start date\n                AppointmentTemplateController.getInstance().getModel().tempEvent.start = date[0];\n                AppointmentTemplateController.getInstance().getModel().tempEvent.end = date[1];\n            }\n        });\n\n        this.setupActionButtons();\n        logger('Completed setup of detail modal for appointment templates');\n    }\n\n    public setupAppointmentTypeDropDown(appointmentTypes: any[]) {\n\n        let types: any[] = [];\n\n        appointmentTypes.forEach((type: any) => {\n            if (!(type.isStatus)) types.push(type.name);\n        });\n\n        // add the patient search values to the data of the select dropdown\n        this.viewElements.appointmentTypeDropdown = select('#event-appt-type-template', {\n            data: types,\n            onChange: (event: any, inst: any) => {\n                AppointmentTemplateController.getInstance().getModel().tempEvent.type = event.valueText;\n            }\n        });\n    }\n\n    public setupProviderDropdown(providers: any[]) {\n        // add the patient search values to the data of the select dropdown\n        this.viewElements.providersDropdown = select('#event-provider-template', {\n            data: providers,\n            onChange: (event: any, inst: any) => {\n                AppointmentTemplateController.getInstance().getModel().tempEvent.provider = event.valueText;\n                AppointmentTemplateController.getInstance().getModel().tempEvent.resource = event.value;\n\n            }\n        });\n\n    }\n\n    public startCreateAppointmentTemplate(elm: HTMLElement) {\n        // hide delete button inside add popup\n        this.viewElements.deleteButton.style.display = 'none';\n        this.viewElements.appointmentTypeEl.style.display = 'block';\n\n\n        // set popup header text and buttons for adding\n        this.viewElements.popup.setOptions({\n            headerText: 'New event',\n            buttons: [\n                {\n                    text: 'Cancel',\n                    keyCode: 'esc',\n                    handler: function() {\n                        AppointmentTemplateView.getInstance().getCalender().removeEvent(AppointmentTemplateController.getInstance().getModel().tempEvent);\n                    }\n                },\n                {\n                    text: 'Add',\n                    keyCode: 'enter',\n                    handler: function () {\n                        let date = AppointmentTemplateDetailModal.getInstance().viewElements.range.getVal();\n                        // store the event created by the UI\n                        let mobiId = AppointmentTemplateController.getInstance().getModel().tempEvent.id;\n                        // generate a new UUID\n                        let appointmentId = v4();\n                        // get the colour for the event type\n                        let colour = AppointmentTemplateController.getInstance().getColourForAppointmentType('Consulting');\n\n                        let createdOn = parseInt(moment().format('YYYYDDMMHHmmss'));\n\n                        let updatedEvent = {\n                            id: appointmentId,\n                            allDay: false,\n                            start: date[0],\n                            end: date[1],\n                            free: false,\n                            color: colour,\n                            editable: true,\n                            resource: AppointmentTemplateController.getInstance().getModel().tempEvent.resource,\n                            createdBy: SecurityManager.getInstance().getLoggedInUsername(),\n                            created: createdOn,\n                            modified: createdOn,\n                            type: AppointmentTemplateController.getInstance().getModel().tempEvent.type,\n                            provider: AppointmentTemplateController.getInstance().getModel().tempEvent.provider\n                        };\n                        logger('inserting');\n                        logger(updatedEvent);\n\n                        // remove the original event\n                        AppointmentTemplateView.getInstance().getCalender().removeEvent([mobiId]);\n                        AppointmentTemplateView.getInstance().getCalender().addEvent(updatedEvent);\n                        Controller.getInstance().getStateManager().addNewItemToState(\n                            STATE_NAMES.appointmentTemplates,\n                            AppointmentTemplateController.getInstance().getAppointmentTemplateFromEvent(updatedEvent),\n                            false);\n\n                        // navigate the calendar to the correct view\n                        AppointmentTemplateView.getInstance().getCalender().navigate(updatedEvent.start);\n                        AppointmentTemplateDetailModal.getInstance().close();\n                    },\n                    cssClass: 'mbsc-popup-button-primary'\n                }\n            ]\n        });\n\n        // fill popup with a new event data\n        this.viewElements.range.setVal([AppointmentTemplateController.getInstance().getModel().tempEvent.start, AppointmentTemplateController.getInstance().getModel().tempEvent.end]);\n        this.viewElements.range.setOptions({\n            controls: AppointmentTemplateController.getInstance().getModel().tempEvent.allDay ? ['date'] : ['datetime'],\n            responsive: AppointmentTemplateController.getInstance().getModel().tempEvent.allDay ? AppointmentTemplateDetailModal.datePickerResponsive : AppointmentTemplateDetailModal.datetimePickerResponsive\n        });\n\n        this.viewElements.appointmentTypeDropdown.setVal('');\n        this.viewElements.providersDropdown.setVal(AppointmentTemplateController.getInstance().getModel().tempEvent.resource);\n\n        // set anchor for the popup\n        this.viewElements.popup.setOptions({anchor: elm});\n\n        this.viewElements.popup.open();\n    }\n\n    public updateAppointmentTemplate(args: any) {\n        let ev = args.event;\n\n        // show delete button inside edit popup\n        this.viewElements.deleteButton.style.display = 'block';\n        this.viewElements.appointmentTypeEl.style.display = 'none';\n\n\n        // set popup header text and buttons for editing\n        this.viewElements.popup.setOptions({\n            headerText: 'Edit event',\n            buttons: [\n                {\n                    text: 'Cancel',\n                    keyCode: 'esc',\n                    handler: function() {\n                        AppointmentTemplateView.getInstance().getCalender().updateEvent(AppointmentTemplateController.getInstance().getModel().oldEvent);\n                    }\n                },\n                {\n                    text: 'Save',\n                    keyCode: 'enter',\n                    handler: function () {\n                        let date = AppointmentTemplateDetailModal.getInstance().viewElements.range.getVal();\n                        // update event with the new properties on save button click\n                        let createdOn = parseInt(moment().format('YYYYDDMMHHmmss'));\n                        //\n                        let updatedEvent = {\n                            id: ev.id,\n                            allDay: false,\n                            start: date[0],\n                            end: date[1],\n                            free: false,\n                            editable: true,\n                            resource: ev.resource,\n                            createdBy: SecurityManager.getInstance().getLoggedInUsername(),\n                            created: ev.created,\n                            modified: createdOn,\n                            type: ev.type,\n                            provider: ev.provider\n                        };\n                        \n                        // @ts-ignore\n                        updatedEvent.color = AppointmentTemplateController.getInstance().getColourForAppointmentTemplate(updatedEvent);\n                        logger('updated');\n                        logger(updatedEvent)\n                        AppointmentTemplateView.getInstance().getCalender().updateEvent(updatedEvent);\n                        Controller.getInstance().getStateManager().updateItemInState(\n                            STATE_NAMES.appointmentTemplates,\n                            AppointmentTemplateController.getInstance().getAppointmentTemplateFromEvent(updatedEvent),\n                            false);\n                        // navigate the calendar to the correct view\n\n                        AppointmentTemplateView.getInstance().getCalender().navigate(date[0]);\n                        AppointmentTemplateDetailModal.getInstance().close();\n                    },\n                    cssClass: 'mbsc-popup-button-primary'\n                }\n            ]\n        });\n\n        // fill popup with the selected event data\n        this.viewElements.range.setVal([ev.start, ev.end]);\n\n        // change range settings based on the allDay\n        this.viewElements.range.setOptions({\n            controls: ev.allDay ? ['date'] : ['datetime'],\n            responsive: ev.allDay ? AppointmentTemplateDetailModal.datePickerResponsive : AppointmentTemplateDetailModal.datetimePickerResponsive\n        });\n\n        // set the appointment type and patient\n        this.viewElements.appointmentTypeDropdown.setVal(ev.type);\n        this.viewElements.providersDropdown.setVal(ev.resource);\n\n        // set anchor for the popup\n        this.viewElements.popup.setOptions({anchor: args.domEvent.currentTarget});\n        this.viewElements.popup.open();\n    }\n\n    protected setupActionButtons() {\n        this.viewElements.deleteButton.addEventListener('click', function () {\n            // delete current event on button click\n            //\n            AppointmentTemplateView.getInstance().getCalender().removeEvent(AppointmentTemplateController.getInstance().getModel().tempEvent);\n            Controller.getInstance().getStateManager().removeItemFromState(\n                STATE_NAMES.appointmentTemplates,\n                AppointmentTemplateController.getInstance().getAppointmentTemplateFromEvent(AppointmentTemplateController.getInstance().getModel().tempEvent),\n                false);\n\n            AppointmentTemplateDetailModal.getInstance().close();\n\n            // save a local reference to the deleted event\n            let deletedEvent = AppointmentTemplateController.getInstance().getModel().tempEvent;\n\n            //\n            snackbar({\n                button: {\n                    action: function () {\n                        //\n                        AppointmentTemplateView.getInstance().getCalender().addEvent(deletedEvent);\n                        Controller.getInstance().getStateManager().addNewItemToState(\n                            STATE_NAMES.appointmentTemplates,\n                            AppointmentTemplateController.getInstance().getAppointmentTemplateFromEvent(deletedEvent),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Event deleted'\n            });\n        });\n\n    }\n\n}\n","import {AppointmentTemplateView} from \"./AppointmentTemplateView\";\nimport {Checkbox, enhance, Input, registerComponent} from \"@mobiscroll/javascript\";\n\nexport class AppointmentTemplateFilterView {\n    private static _instance: AppointmentTemplateFilterView;\n\n    public static getInstance(): AppointmentTemplateFilterView {\n        if (!(AppointmentTemplateFilterView._instance)) {\n            AppointmentTemplateFilterView._instance = new AppointmentTemplateFilterView();\n        }\n        return AppointmentTemplateFilterView._instance;\n    }\n\n    private providersEl: HTMLDivElement|null;\n\n    public onDocumentLoaded() {\n        this.providersEl = <HTMLDivElement>document.getElementById('providerFilter');\n        registerComponent(Checkbox);\n        registerComponent(Input);\n    }\n\n    public populateProviders(providers:any[]): void {\n        if (providers && this.providersEl) {\n            providers.forEach((provider:any) => {\n                let labelEl = document.createElement('label');\n                let inputEl = document.createElement('input');\n                inputEl.setAttribute('type','checkbox');\n                inputEl.setAttribute('value',provider.name);\n                inputEl.setAttribute(\"checked\",'');\n                inputEl.setAttribute(\"mbsc-checkbox\",'');\n                inputEl.setAttribute('data-label',provider.name);\n                inputEl.classList.add('template-provider-checkbox');\n                labelEl.appendChild(inputEl);\n\n                this.providersEl.appendChild(labelEl);\n\n\n            });\n            enhance(this.providersEl);\n\n\n            document.querySelectorAll('.template-provider-checkbox').forEach(function (elm) {\n                elm.addEventListener('change', function () {\n                    let checkboxList = document.querySelectorAll('.template-provider-checkbox');\n                    let selected:any[] = [];\n\n                    for (let i = 0; i < checkboxList.length; i++) {\n                        let checkbox = checkboxList[i];\n                        // @ts-ignore\n                        if (checkbox.checked) {\n                            // @ts-ignore\n                            selected.push({id:checkbox.value,name:checkbox.value});\n                        }\n                    }\n\n                    AppointmentTemplateView.getInstance().getCalender().setOptions({\n                       resources: selected\n                    });\n                });\n            });\n\n        }\n\n    }\n\n}","import {AppointmentTemplateController} from \"./AppointmentTemplateController\";\nimport { eventcalendar, Eventcalendar, snackbar} from \"@mobiscroll/javascript\";\nimport debug from \"debug\";\nimport {STATE_NAMES, VIEW_CONTAINER} from \"../AppTypes\";\nimport moment from \"moment\";\nimport Controller from \"../Controller\";\nimport {AppointmentTemplateDetailModal} from \"./AppointmentTemplateDetailModal\";\n\nconst logger = debug('appointment-template-view');\n\ntype AppointmentTemplateViewElements = {\n    calendar: Eventcalendar | null,\n}\n\nexport class AppointmentTemplateView {\n    private static _instance: AppointmentTemplateView;\n\n    public static getInstance(): AppointmentTemplateView {\n        if (!(AppointmentTemplateView._instance)) {\n            AppointmentTemplateView._instance = new AppointmentTemplateView();\n        }\n        return AppointmentTemplateView._instance;\n    }\n\n    private constructor() {\n        this.handleAppointmentTemplateRendering = this.handleAppointmentTemplateRendering.bind(this);\n    }\n\n\n    private viewElements: AppointmentTemplateViewElements = {\n        calendar: null,\n    }\n\n\n    getCalender(): Eventcalendar {\n        return this.viewElements.calendar;\n    }\n\n    handleAppointmentTemplateRendering(data: any) {\n        logger(`Rendering event`);\n        logger(data);\n        const icons = AppointmentTemplateController.getInstance().getIconsForEventTemplate(data.original);\n        logger(`Applicable icons`);\n        logger(icons);\n\n        let buffer = '' +\n            '<div class=\"md-custom-event-cont\" style=\"border-left: 5px solid ' + data.color + ';background:' + data.color + '\">' +\n            '  <div class=\"md-custom-event-wrapper\">' +\n            '    <div class=\"container-fluid\">' +\n            '    <div class=\"row \">' +\n            `      <div style=\"background:${data.color}\" class=\"col-12 md-custom-event-template-type\">${data.original.type}</div>` +\n            '      <div class=\"col-12 d-flex w-100 justify-content-between md-custom-event-time\">' +\n            `        <span>${data.start} - ${data.end}</span>`;\n        if (icons.trim().length > 0) {\n            buffer += '' +\n                `        <span class=\"md-custom-event-img-cont\">${icons}</span>` +\n                '      </div>' +\n                '  </div>' +\n                '</div>';\n        } else {\n            buffer += '' +\n                '  </div>' +\n                '</div>';\n        }\n        return buffer;\n    }\n\n\n    public onDocumentLoaded() {\n\n        AppointmentTemplateDetailModal.getInstance().onDocumentLoaded();\n\n\n        let options: any;\n        if (AppointmentTemplateController.getInstance().getModel().clinicConfig) {\n            logger('Using clinic config options');\n            options = {\n                clickToCreate: AppointmentTemplateController.getInstance().getModel().clinicConfig.clickToCreate,\n                dragTimeStep: AppointmentTemplateController.getInstance().getModel().clinicConfig.dragTimeStep,\n                dragToCreate: AppointmentTemplateController.getInstance().getModel().clinicConfig.dragToCreate,\n                dragToMove: AppointmentTemplateController.getInstance().getModel().clinicConfig.dragToMove,\n                dragToResize: AppointmentTemplateController.getInstance().getModel().clinicConfig.dragToResize,\n                min: moment().subtract(AppointmentTemplateController.getInstance().getModel().clinicConfig.min, \"months\"),\n                controls: AppointmentTemplateController.getInstance().getModel().clinicConfig.controls,\n                showControls: AppointmentTemplateController.getInstance().getModel().clinicConfig.showControls,\n                view: AppointmentTemplateController.getInstance().getModel().clinicConfig.view,\n                invalidateEvent: AppointmentTemplateController.getInstance().getModel().clinicConfig.invalidateEvent,\n                invalid: AppointmentTemplateController.getInstance().getModel().clinicConfig.invalid,\n            }\n            options.view.schedule.type = 'week';\n        } else {\n            logger('Using DEFAULT config options');\n            options = {\n                clickToCreate: 'double',\n                dragTimeStep: 5,\n                dragToCreate: true,\n                dragToMove: true,\n                dragToResize: true,\n                min: moment().subtract(3, \"months\"),\n                controls: ['calendar'],\n                showControls: true,\n                view: {\n                    schedule: {\n                        type: 'week',\n                        startDay: 1,\n                        endDay: 5,\n                        startTime: '09:00',\n                        endTime: '17:00',\n                        timeCellStep: 15,\n                        timeLabelStep: 60\n                    }\n                },\n                invalidateEvent: 'strict',\n                invalid: [{\n                    recurring: {\n                        repeat: 'weekly',\n                        weekDays: 'SA,SU'\n                    }\n                },\n                    {\n                        start: '12:00',\n                        end: '13:00',\n                        title: 'Lunch Break',\n                        recurring: {\n                            repeat: 'weekly',\n                            weekDays: 'MO,TU,WE,TH,FR'\n                        }\n                    }\n                ]\n\n            }\n        }\n\n\n        options.onPageLoading = (event: any, inst: any) => {\n            AppointmentTemplateController.getInstance().onPageLoading(event, inst);\n        };\n        options.onEventCreated = (event: any, inst: any) => {\n            AppointmentTemplateDetailModal.getInstance().close();\n            // store temporary event\n            AppointmentTemplateController.getInstance().getModel().tempEvent = event.event;\n            logger('Creating event');\n            logger(event);\n\n            AppointmentTemplateDetailModal.getInstance().startCreateAppointmentTemplate(event.target);\n        };\n\n        options.onEventDeleted = (event: any, inst: any) => {\n            snackbar({\n                button: {\n                    action: function () {\n                        // @ts-ignore\n                        AppointmentTemplateView.getInstance().viewElements.calendar.addEvent(event.event);\n                        Controller.getInstance().getStateManager().addNewItemToState(\n                            STATE_NAMES.appointmentTemplates,\n                            AppointmentTemplateController.getInstance().getAppointmentTemplateFromEvent(event.event),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Event deleted'\n            });\n        };\n        options.onEventClick = (args: any) => {\n            logger(args.event);\n            AppointmentTemplateController.getInstance().getModel().oldEvent = Object.assign({}, args.event);\n            AppointmentTemplateController.getInstance().getModel().tempEvent = args.event;\n\n            if (!AppointmentTemplateDetailModal.getInstance().isVisible()) {\n                logger(args);\n                AppointmentTemplateDetailModal.getInstance().updateAppointmentTemplate(args);\n            }\n        }\n        options.renderScheduleEvent = this.handleAppointmentTemplateRendering;\n        options.onEventUpdated = (args:any) => {\n\n            // user has dragged event - update the appointment\n            Controller.getInstance().getStateManager().updateItemInState(\n                STATE_NAMES.appointmentTemplates,\n                AppointmentTemplateController.getInstance().getAppointmentTemplateFromEvent(args.event),\n                false);\n        }\n\n        if (AppointmentTemplateController.getInstance().getModel().providers) {\n            let providers: any[] = [];\n\n            AppointmentTemplateController.getInstance().getModel().providers.forEach((provider: any) => {\n                if (provider.isCurrent) providers.push({\n                    text: provider.name,\n                    value: provider.name,\n                    id: provider.name,\n                    name: provider.name\n                });\n            });\n\n            if (this.viewElements.calendar) this.viewElements.calendar.setOptions(\n                {\n                    resources: providers,\n                    groupBy: 'date'\n                }\n            );\n\n        }\n\n        // @ts-ignore\n        this.viewElements.calendar = eventcalendar(document.getElementById('templateDetail'), options);\n    }\n\n\n    public applyClinicConfig(clinicConfig: any) {\n        if (this.viewElements.calendar) {\n            logger('State changed, using clinic config options');\n            const config = JSON.parse(JSON.stringify(clinicConfig));\n            config.view.schedule.type = 'week';\n\n            this.viewElements.calendar.setOptions({\n                clickToCreate: config.clickToCreate,\n                dragTimeStep: config.dragTimeStep,\n                dragToCreate: config.dragToCreate,\n                dragToMove: config.dragToMove,\n                dragToResize: config.dragToResize,\n                showControls: config.showControls,\n                view: config.view,\n                invalidateEvent: config.invalidateEvent,\n                invalid: config.invalid,\n            });\n\n\n        }\n        AppointmentTemplateDetailModal.getInstance().applyClinicConfig(clinicConfig);\n\n    }\n\n\n    public setupProviders(providersCollection: any[]) {\n        let providers: any[] = [];\n\n        providersCollection.forEach((provider: any) => {\n            if (provider.isCurrent) providers.push({\n                text: provider.name,\n                value: provider.name,\n                id: provider.name,\n                name: provider.name\n            });\n        });\n\n\n        if (this.viewElements.calendar) this.viewElements.calendar.setOptions(\n            {\n                resources: providers,\n                groupBy: 'date'\n            }\n        );\n\n        AppointmentTemplateDetailModal.getInstance().setupProviderDropdown(providers);\n    }\n\n\n}\n","import {AppointmentController} from \"./AppointmentController\";\nimport {datepicker, Datepicker, eventcalendar, Eventcalendar, snackbar} from \"@mobiscroll/javascript\";\nimport debug from \"debug\";\nimport {STATE_NAMES, VIEW_CONTAINER} from \"../AppTypes\";\nimport moment from \"moment\";\nimport Controller from \"../Controller\";\nimport {AppointmentDetailModal} from \"./AppointmentDetailModal\";\n\nconst logger = debug('appointment-view');\n\ntype AppointmentViewElements = {\n    datePicker: Datepicker | null,\n    calendar: Eventcalendar | null,\n}\n\nexport class AppointmentBookView {\n    private static _instance: AppointmentBookView;\n\n    public static getInstance(): AppointmentBookView {\n        if (!(AppointmentBookView._instance)) {\n            AppointmentBookView._instance = new AppointmentBookView();\n        }\n        return AppointmentBookView._instance;\n    }\n\n    private constructor() {\n        this.handleAppointmentRendering = this.handleAppointmentRendering.bind(this);\n    }\n\n\n    private viewElements: AppointmentViewElements = {\n        datePicker: null,\n        calendar: null,\n    }\n\n    protected setupDatePicker() {\n        // @ts-ignore\n        this.viewElements.datePicker = datepicker(document.getElementById(VIEW_CONTAINER.calendarControl), {\n            controls: ['calendar'],\n            display: \"inline\",\n            dateFormat: 'YYYYMMDD',\n            dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n            showWeekNumbers: true,\n            onChange: (event: any, inst: any) => {\n                AppointmentBookView.getInstance().viewElements.calendar?.navigate(event.value);\n            }\n        });\n    }\n\n    getCalender(): Eventcalendar {\n        return this.viewElements.calendar;\n    }\n\n    handleAppointmentRendering(data: any) {\n        logger(`Rendering event`);\n        logger(data);\n        const icons = AppointmentController.getInstance().getIconsForEvent(data.original);\n        logger(`Applicable icons`);\n        logger(icons);\n\n        let buffer = '' +\n            '<div class=\"md-custom-event-cont\" style=\"border-left: 5px solid ' + data.color + ';background:' + data.color + '\">' +\n            '  <div class=\"md-custom-event-wrapper\">' +\n            '    <div class=\"container-fluid\">' +\n            '    <div class=\"row \">' +\n            `      <div style=\"background:${data.color}\" class=\"col-sm-12 col-md-2 md-custom-event-type\">${data.original.type}</div>` +\n            `      <div class=\"col-sm-4 col-md-6 md-custom-event-title\">${data.title}</div>` +\n            '      <div class=\"col-sm-6 col-md-4 d-flex w-100 justify-content-between md-custom-event-time\">' +\n            `        <span>${data.start} - ${data.end}</span>`;\n        if (icons.trim().length > 0) {\n            buffer += '' +\n                `        <span class=\"md-custom-event-img-cont\">${icons}</span>` +\n                '      </div>' +\n                '  </div>' +\n                '</div>';\n        } else {\n            buffer += '' +\n                '  </div>' +\n                '</div>';\n        }\n        return buffer;\n    }\n\n\n    public onDocumentLoaded() {\n\n        this.setupDatePicker();\n        AppointmentDetailModal.getInstance().onDocumentLoaded();\n\n\n        let options: any;\n        if (AppointmentController.getInstance().getModel().clinicConfig) {\n            logger('Using clinic config options');\n            options = {\n                clickToCreate: AppointmentController.getInstance().getModel().clinicConfig.clickToCreate,\n                dragTimeStep: AppointmentController.getInstance().getModel().clinicConfig.dragTimeStep,\n                dragToCreate: AppointmentController.getInstance().getModel().clinicConfig.dragToCreate,\n                dragToMove: AppointmentController.getInstance().getModel().clinicConfig.dragToMove,\n                dragToResize: AppointmentController.getInstance().getModel().clinicConfig.dragToResize,\n                min: moment().subtract(AppointmentController.getInstance().getModel().clinicConfig.min, \"months\"),\n                controls: AppointmentController.getInstance().getModel().clinicConfig.controls,\n                showControls: AppointmentController.getInstance().getModel().clinicConfig.showControls,\n                view: AppointmentController.getInstance().getModel().clinicConfig.view,\n                invalidateEvent: AppointmentController.getInstance().getModel().clinicConfig.invalidateEvent,\n                invalid: AppointmentController.getInstance().getModel().clinicConfig.invalid,\n            }\n        } else {\n            logger('Using DEFAULT config options');\n            options = {\n                clickToCreate: 'double',\n                dragTimeStep: 5,\n                dragToCreate: true,\n                dragToMove: true,\n                dragToResize: true,\n                min: moment().subtract(3, \"months\"),\n                controls: ['calendar'],\n                showControls: true,\n                view: {\n                    schedule: {\n                        type: 'day',\n                        startDay: 1,\n                        endDay: 5,\n                        startTime: '09:00',\n                        endTime: '17:00',\n                        timeCellStep: 15,\n                        timeLabelStep: 60\n                    }\n                },\n                invalidateEvent: 'strict',\n                invalid: [{\n                    recurring: {\n                        repeat: 'weekly',\n                        weekDays: 'SA,SU'\n                    }\n                },\n                    {\n                        start: '12:00',\n                        end: '13:00',\n                        title: 'Lunch Break',\n                        recurring: {\n                            repeat: 'weekly',\n                            weekDays: 'MO,TU,WE,TH,FR'\n                        }\n                    }\n                ]\n\n            }\n        }\n\n\n        options.onSelectedDateChange = (event: any, inst: any) => {\n            AppointmentBookView.getInstance().viewElements.datePicker?.setVal(event.date);\n        };\n        options.onPageLoading = (event: any, inst: any) => {\n            AppointmentController.getInstance().onPageLoading(event, inst);\n        };\n        options.onEventCreated = (event: any, inst: any) => {\n            AppointmentDetailModal.getInstance().close();\n            // store temporary event\n            AppointmentController.getInstance().getModel().tempEvent = event.event;\n            logger('Creating event');\n            logger(event);\n\n            AppointmentDetailModal.getInstance().startCreateAppointment(event.target);\n        };\n\n        options.onEventDeleted = (event: any, inst: any) => {\n            snackbar({\n                button: {\n                    action: function () {\n                        // @ts-ignore\n                        AppointmentBookView.getInstance().viewElements.calendar.addEvent(event.event);\n                        Controller.getInstance().getStateManager().addNewItemToState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(event.event),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Event deleted'\n            });\n        };\n        options.onEventClick = (args: any) => {\n            logger(args.event);\n            if (args.event.editable) {\n                AppointmentController.getInstance().getModel().oldEvent = Object.assign({}, args.event);\n                AppointmentController.getInstance().getModel().tempEvent = args.event;\n\n                if (!AppointmentDetailModal.getInstance().isVisible()) {\n                    logger(args);\n                    AppointmentDetailModal.getInstance().updateAppointment(args);\n                }\n            }\n        }\n        options.renderScheduleEvent = this.handleAppointmentRendering;\n        options.onEventUpdated = (args:any) => {\n            // user has dragged event - update the appointment\n            Controller.getInstance().getStateManager().updateItemInState(\n                STATE_NAMES.appointments,\n                AppointmentController.getInstance().getAppointmentFromEvent(args.event),\n                false);\n\n        }\n\n        if (AppointmentController.getInstance().getModel().providers) {\n            let providers: any[] = [];\n\n            AppointmentController.getInstance().getModel().providers.forEach((provider: any) => {\n                if (provider.isCurrent) providers.push({\n                    text: provider.name,\n                    value: provider.name,\n                    id: provider.name,\n                    name: provider.name\n                });\n            });\n\n            if (this.viewElements.calendar) this.viewElements.calendar.setOptions(\n                {\n                    resources: providers,\n                    groupBy: 'date'\n                }\n            );\n\n        }\n\n        // @ts-ignore\n        this.viewElements.calendar = eventcalendar(document.getElementById(VIEW_CONTAINER.calendarDetail), options);\n    }\n\n\n    public applyClinicConfig(clinicConfig: any) {\n        if (this.viewElements.calendar) {\n            logger('State changed, using clinic config options');\n\n            this.viewElements.calendar.setOptions({\n                clickToCreate: clinicConfig.clickToCreate,\n                dragTimeStep: clinicConfig.dragTimeStep,\n                dragToCreate: clinicConfig.dragToCreate,\n                dragToMove: clinicConfig.dragToMove,\n                dragToResize: clinicConfig.dragToResize,\n                min: moment().subtract(clinicConfig.min, \"months\"),\n                showControls: clinicConfig.showControls,\n                view: clinicConfig.view,\n                invalidateEvent: clinicConfig.invalidateEvent,\n                invalid: clinicConfig.invalid,\n            });\n\n\n        }\n        AppointmentDetailModal.getInstance().applyClinicConfig(clinicConfig);\n\n    }\n\n\n    public setupProviders(providersCollection: any[]) {\n        let providers: any[] = [];\n\n        providersCollection.forEach((provider: any) => {\n            if (provider.isCurrent) providers.push({\n                text: provider.name,\n                value: provider.name,\n                id: provider.name,\n                name: provider.name\n            });\n        });\n\n\n        if (this.viewElements.calendar) this.viewElements.calendar.setOptions(\n            {\n                resources: providers,\n                groupBy: 'date'\n            }\n        );\n\n        AppointmentDetailModal.getInstance().setupProviderDropdown(providers);\n    }\n\n\n}","import debug from \"debug\";\nimport moment from \"moment\";\nimport {STATE_NAMES} from \"../AppTypes\";\nimport Controller from \"../Controller\";\nimport {SecurityManager, StateChangeListener} from \"ui-framework-jps\";\n\nimport {AppointmentBookView} from \"./AppointmentBookView\";\nimport {AppointmentFilterView} from \"./AppointmentFilterView\";\nimport {AppointmentDetailModal} from \"./AppointmentDetailModal\";\nimport {AppointmentTemplateController} from \"../appointment-templates/AppointmentTemplateController\";\nimport {v4} from \"uuid\";\nimport {computeTimeStringFromStartTimeAndDurationInSeconds} from \"../DurationFunctions\";\n\n\nconst logger = debug('appointment-controller');\n\n\ntype AppointmentDataElements = {\n    appointmentTypes: any[] | null,\n    clinicConfig: any | null,\n    providers: any[] | null,\n    oldEvent: any | null,\n    tempEvent: any,\n    loadDate:number,\n    loadDateFinish:number,\n}\n\nexport class AppointmentController implements StateChangeListener {\n    private static _instance: AppointmentController;\n\n    public static getInstance(): AppointmentController {\n        if (!(AppointmentController._instance)) {\n            AppointmentController._instance = new AppointmentController();\n        }\n        return AppointmentController._instance;\n    }\n\n    public static APPOINTMENT_STATUS_ARRIVED = 'Patient Arrived';\n    public static APPOINTMENT_STATUS_READY_FOR_BILLING = 'Ready For Billing';\n    public static APPOINTMENT_STATUS_BILLING_COMPLETE = 'Billing Complete';\n    public static APPOINTMENT_TYPE_PATIENT_CANCELLED = 'Patient Cancelled';\n    public static APPOINTMENT_TYPE_PATIENT_DNA = 'Did Not Arrive';\n\n\n    private dataElements: AppointmentDataElements = {\n        appointmentTypes: null,\n        clinicConfig: null,\n        providers: null,\n        oldEvent: null,\n        tempEvent: {},\n        loadDate:0,\n        loadDateFinish:0\n    };\n\n    public getModel(): AppointmentDataElements {\n        return this.dataElements;\n    }\n\n    public onDocumentLoaded() {\n        AppointmentBookView.getInstance().onDocumentLoaded();\n        AppointmentFilterView.getInstance().onDocumentLoaded();\n    }\n\n\n    private constructor() {\n        this.onPageLoading = this.onPageLoading.bind(this);\n\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.clinicConfig, this);\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.appointmentTypes, this);\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.patientSearch, this);\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.providers, this);\n        Controller.getInstance().getStateManager().addChangeListenerForName(STATE_NAMES.appointments, this);\n\n    }\n\n    public getIconForAppointmentType(appointmentType: string) {\n        logger(`Getting icon for appoint type ${appointmentType}`);\n        let result = ``;\n        if (this.dataElements.appointmentTypes) {\n            let foundIndex = this.dataElements.appointmentTypes.findIndex((type) => type.name === appointmentType);\n            if (foundIndex >= 0) {\n                if (this.dataElements.appointmentTypes[foundIndex].icon) {\n                    result = `<i class=\"md-custom-event-icon ${this.dataElements.appointmentTypes[foundIndex].icon}\"></i>`;\n                }\n\n            }\n        }\n        return result;\n    }\n\n\n    public getIconsForEvent(event: any): string {\n        let buffer = '';\n        if (event.arrivalTime) {\n            if (event.arrivalTime.trim().length > 0) {\n                buffer += this.getIconForAppointmentType(AppointmentController.APPOINTMENT_STATUS_ARRIVED);\n            }\n        }\n        if (event.readyForBilling) {\n            buffer += this.getIconForAppointmentType(AppointmentController.APPOINTMENT_STATUS_READY_FOR_BILLING);\n        }\n        if (event.isBilled) {\n            buffer += this.getIconForAppointmentType(AppointmentController.APPOINTMENT_STATUS_BILLING_COMPLETE);\n        }\n        buffer += this.getIconForAppointmentType(event.type);\n\n        return buffer;\n    }\n\n    public getColourForAppointmentType(appointmentType: string) {\n        let result = `rgba(10, 100, 100, 50)`;\n        if (this.dataElements.appointmentTypes) {\n            let foundIndex = this.dataElements.appointmentTypes.findIndex((type) => type.name === appointmentType);\n            if (foundIndex >= 0) result = this.dataElements.appointmentTypes[foundIndex].colour;\n        }\n        return result;\n    }\n\n    public getColourForAppointment(appointment: any) {\n        let colour = this.getColourForAppointmentType(appointment.type);;\n        if (appointment.arrivalTime) {\n            if (appointment.arrivalTime.trim().length > 0) {\n                colour = this.getColourForAppointmentType(AppointmentController.APPOINTMENT_STATUS_ARRIVED);\n            }\n        }\n        if (appointment.readyForBilling || appointment.isBilled || appointment.isCancelled || appointment.isDNA) {\n            if (appointment.readyForBilling) {\n                colour = this.getColourForAppointmentType(AppointmentController.APPOINTMENT_STATUS_READY_FOR_BILLING);\n            }\n            if (appointment.isBilled) {\n                colour = this.getColourForAppointmentType(AppointmentController.APPOINTMENT_STATUS_BILLING_COMPLETE);\n            }\n            if (appointment.isCancelled) {\n                colour = this.getColourForAppointmentType(AppointmentController.APPOINTMENT_TYPE_PATIENT_CANCELLED);\n            }\n            if (appointment.isDNA) {\n                colour = this.getColourForAppointmentType(AppointmentController.APPOINTMENT_TYPE_PATIENT_DNA);\n            }\n        }\n        return colour;\n    }\n\n    public getEventForAppointment(loadDate:number, appointment:any):any {\n        const today = parseInt(moment().format('YYYYMMDD'));\n\n        let canEdit = ((loadDate >= today) && (!appointment.isDNA && !appointment.isCancelled) && (!appointment.isBilled));\n        const timeString = computeTimeStringFromStartTimeAndDurationInSeconds(appointment.time,appointment.duration);\n\n        let result = {\n            id: appointment._id,\n            start: moment(`${loadDate}${appointment.time}`, 'YYYYMMDDHHmmss'),\n            end: moment(`${loadDate}${timeString}`, 'YYYYMMDDHHmm'),\n            title: appointment.name,\n            description: appointment.note,\n            allDay: false,\n            editable: canEdit,\n            resource: appointment.provider,\n            patientId: appointment._patient,\n            isDNA: appointment.isDNA,\n            isCancelled: appointment.isCancelled,\n            createdBy: appointment.createdBy,\n            created: appointment.created,\n            modified: appointment.modified,\n            arrivalTime: appointment.arrivalTime,\n            type: appointment.type,\n            provider: appointment.provider,\n            readyForBilling: appointment.readyForBilling,\n            billingItems: appointment.billingItems,\n            isBilled:appointment.isBilled\n        }\n        // @ts-ignore\n        result.color = this.getColourForAppointment(appointment);\n\n\n        return result;\n\n    }\n\n\n    private addTemplateEvents(loadDate:number, day:number, currentAppointments:any[]) {\n        logger('Loading templated events for day ' + day);\n        const appointmentTemplates = Controller.getInstance().getStateManager().getStateByName(STATE_NAMES.appointmentTemplates);\n        appointmentTemplates.forEach((template:any) => {\n            logger(template);\n            if (template.day === day) { // only template appointments for the day number\n                // is there already an appointment on display that matches the template?\n                const foundIndex = currentAppointments.findIndex((appt) => appt.time === template.time);\n                if (foundIndex < 0) {\n                    logger(`appointment for time ${template.time} not found, creating new appointment`)\n                    // don't already have an appointment for that time\n                    let templatedAppt = AppointmentTemplateController.getInstance().getEventForAppointmentTemplateForDate(loadDate, day, template);\n                    templatedAppt.id = v4();\n                    templatedAppt.title = '';\n                    templatedAppt.description = '';\n                    templatedAppt.patientId = '';\n                    templatedAppt.isDNA = false;\n                    templatedAppt.isCancelled = false;\n                    templatedAppt.readyForBilling = false;\n                    templatedAppt.isBilled = false;\n                    templatedAppt.isDNA = false;\n                    templatedAppt.billingItems = '';\n                    templatedAppt.arrivalTime = '';\n                    templatedAppt.color = AppointmentController.getInstance().getColourForAppointment(templatedAppt);\n\n                    logger(templatedAppt);\n\n                    // add the templated appointment to the persistence\n                    Controller.getInstance().getStateManager().addNewItemToState(\n                        STATE_NAMES.appointments,\n                        AppointmentController.getInstance().getAppointmentFromEvent(templatedAppt),\n                        false);\n                    AppointmentBookView.getInstance().getCalender().addEvent(templatedAppt);\n\n\n                }\n            }\n\n        });\n\n    }\n\n\n    public onPageLoading(event: any, inst: any): void {  // load the events for the view\n        logger(event);\n        const today = parseInt(moment().format('YYYYMMDD'));\n        this.dataElements.loadDate = parseInt(moment(event.firstDay).format('YYYYMMDD'));\n        const loadDateDayNumber = parseInt(moment(event.firstDay).format('d'));\n        this.dataElements.loadDateFinish = parseInt(moment(event.lastDay).format('YYYYMMDD'));\n        logger(`Need to load date range (${this.dataElements.loadDate},${this.dataElements.loadDateFinish})`);\n\n\n        const appointments = Controller.getInstance().getStateManager().getStateByName(STATE_NAMES.appointments);\n        let results: any[] = [];\n        let appointmentsForTheDay:any[] = [];\n        appointments.forEach((appointment: any) => {\n            if ((appointment.start >= this.dataElements.loadDate) && (appointment.start < this.dataElements.loadDateFinish)) {\n                appointmentsForTheDay.push(appointment);\n\n                let result = this.getEventForAppointment(this.dataElements.loadDate,appointment);\n                results.push(result);\n            }\n\n        });\n\n\n\n        inst.setEvents(results);\n\n        // add template appointments as events where an appointment doesn't already exist in the same time slot, they will need unique _ids\n        if (this.dataElements.loadDate >= today) this.addTemplateEvents(this.dataElements.loadDate, loadDateDayNumber, appointmentsForTheDay);\n\n    }\n\n    filterResults(managerName: string, name: string, filterResults: any): void {\n    }\n\n    getListenerName(): string {\n        return \"Appointment Manager\";\n    }\n\n    stateChanged(managerName: string, name: string, newValue: any): void {\n        logger(`Handling state changed ${name}`);\n\n        switch (name) {\n            case STATE_NAMES.clinicConfig: {\n                this.dataElements.clinicConfig = newValue[0];\n                AppointmentBookView.getInstance().applyClinicConfig(this.dataElements.clinicConfig);\n                break;\n            }\n            case (STATE_NAMES.patientSearch): {\n                AppointmentDetailModal.getInstance().setupPatientSearchDropDown(newValue);\n                break;\n            }\n            case (STATE_NAMES.appointmentTypes): {\n                this.dataElements.appointmentTypes = newValue;\n                AppointmentDetailModal.getInstance().setupAppointmentTypeDropDown(newValue);\n                break;\n\n            }\n            case (STATE_NAMES.providers): {\n                this.dataElements.providers = newValue;\n\n                AppointmentFilterView.getInstance().populateProviders(newValue);\n\n                AppointmentBookView.getInstance().setupProviders(newValue);\n\n                break;\n\n            }\n            case (STATE_NAMES.appointments): {\n\n                this.dataElements.loadDate = parseInt(moment().format('YYYYMMDD'));\n                this.dataElements.loadDateFinish = parseInt(moment().add(1,'days').format('YYYYMMDD'));\n                logger(`Need to load date range (${this.dataElements.loadDate},${this.dataElements.loadDateFinish})`);\n\n\n                const appointments = Controller.getInstance().getStateManager().getStateByName(STATE_NAMES.appointments);\n                let results: any[] = [];\n                appointments.forEach((appointment: any) => {\n                    if ((appointment.start >= this.dataElements.loadDate) && (appointment.start < this.dataElements.loadDateFinish)) {\n                        logger('Found appointment');\n                        logger(appointment);\n\n                        let result = this.getEventForAppointment(this.dataElements.loadDate,appointment);\n\n\n                        logger('Converted to event');\n                        logger(result);\n                        results.push(result);\n                    }\n\n                });\n\n                AppointmentBookView.getInstance().getCalender().setEvents(results);\n\n                break;\n\n            }\n\n        }\n    }\n\n    stateChangedItemAdded(managerName: string, name: string, appointment: any): void {\n        if ((name === STATE_NAMES.appointments) && (appointment.createdBy !== SecurityManager.getInstance().getLoggedInUsername())) {\n            logger('New Appointment inserted by another user');\n            logger(appointment);\n\n            if ((appointment.start >= this.dataElements.loadDate) && (appointment.start < this.dataElements.loadDateFinish)) {\n\n                let result = this.getEventForAppointment(this.dataElements.loadDate, appointment);\n                logger('Converted to event');\n                logger(result);\n\n                AppointmentBookView.getInstance().getCalender().addEvent(result);\n            }\n        }\n    }\n\n    stateChangedItemRemoved(managerName: string, name: string, appointment: any): void {\n        if (name === STATE_NAMES.appointments) {\n            logger('Appointment deleted by another user');\n            logger(appointment);\n\n            AppointmentBookView.getInstance().getCalender().removeEvent([appointment._id]);\n        }\n    }\n\n    stateChangedItemUpdated(managerName: string, name: string, itemUpdated: any, appointment: any): void {\n        if ((name === STATE_NAMES.appointmentTemplates) && (appointment.createdBy !== SecurityManager.getInstance().getLoggedInUsername())) {\n            logger('Appointment updated by another user');\n            logger(appointment);\n\n            if ((appointment.start >= this.dataElements.loadDate) && (appointment.start < this.dataElements.loadDateFinish)) {\n\n                let result = this.getEventForAppointment(this.dataElements.loadDate, appointment);\n                logger('Converted to event');\n                logger(result);\n\n                AppointmentBookView.getInstance().getCalender().updateEvent(result);\n            }\n        }\n    }\n\n    public getAppointmentFromEvent(event: any): any {\n        let start = parseInt(moment(event.start).format('YYYYMMDD'));\n        let time = moment(event.start).format('HHmmss');\n        let duration = moment(event.end).diff(moment(event.start), 'seconds');\n\n\n        let appointment = {\n            _id: event.id,\n            name: event.title,\n            note: event.description,\n            start: start,\n            time: time,\n            duration: duration,\n            _patient: event.patientId,\n            isDNA: event.isDNA,\n            isCancelled: event.isCancelled,\n            createdBy: event.createdBy,\n            created: event.created,\n            modified: event.modified,\n            arrivalTime: event.arrivalTime,\n            type: event.type,\n            provider: event.resource,\n            readyForBilling: event.readyForBilling,\n            isBilled: event.isBilled,\n            billingItems: event.billingItems\n        };\n        return appointment;\n    }\n\n\n}\n","import {SELECT, STATE_NAMES} from \"../AppTypes\";\nimport {datepicker, getInst, Popup, popup, select, snackbar} from \"@mobiscroll/javascript\";\nimport {AppointmentController} from \"./AppointmentController\";\nimport Controller from \"../Controller\";\nimport moment from \"moment\";\nimport {AppointmentBookView} from \"./AppointmentBookView\";\nimport {v4} from \"uuid\";\nimport {SecurityManager} from \"ui-framework-jps\";\nimport debug from \"debug\";\nimport {AppointmentTemplateView} from \"../appointment-templates/AppointmentTemplateView\";\nimport {AppointmentTemplateController} from \"../appointment-templates/AppointmentTemplateController\";\n\nconst logger = debug('appointment-detail-view');\n\ntype AppointmentDetailViewElements = {\n    popup: Popup | null,\n    range: any | null,\n    titleInput: HTMLInputElement | null,\n    descriptionTextarea: HTMLTextAreaElement | null,\n    deleteButton: HTMLButtonElement | null,\n    patientArrivedButton: HTMLButtonElement | null,\n    patientCancelledButton: HTMLButtonElement | null,\n    patientDNAButton: HTMLButtonElement | null,\n    readyForBillingButton: HTMLButtonElement | null,\n    billingCompleteButton: HTMLButtonElement | null,\n    patientSearchEl: HTMLSelectElement | null,\n    appointmentTypeEl: HTMLSelectElement | null,\n    patientSearchDropdown: any | null\n    appointmentTypeDropdown: any | null,\n    providersDropdown: any | null,\n    warningsEl: HTMLTextAreaElement | null\n}\n\n\nexport class AppointmentDetailModal {\n\n    private static _instance: AppointmentDetailModal;\n\n    public static getInstance(): AppointmentDetailModal {\n        if (!(AppointmentDetailModal._instance)) {\n            AppointmentDetailModal._instance = new AppointmentDetailModal();\n        }\n        return AppointmentDetailModal._instance;\n    }\n\n\n    private static datePickerResponsive = {\n        medium: {\n            controls: ['calendar'],\n            touchUi: false\n        }\n    }\n    private static datetimePickerResponsive = {\n        medium: {\n            controls: ['calendar', 'time'],\n            touchUi: false\n        }\n    }\n\n    private patients: any[];\n\n    private constructor() {\n        this.patients = [];\n    }\n\n    private viewElements: AppointmentDetailViewElements = {\n        popup: null,\n        range: null,\n        titleInput: null,\n        descriptionTextarea: null,\n        deleteButton: null,\n        patientArrivedButton: null,\n        patientCancelledButton: null,\n        patientDNAButton: null,\n        readyForBillingButton: null,\n        billingCompleteButton: null,\n        patientSearchEl: null,\n        appointmentTypeEl: null,\n        appointmentTypeDropdown: null,\n        patientSearchDropdown: null,\n        providersDropdown: null,\n        warningsEl: null\n    }\n\n    public close() {\n        this.viewElements.popup.close();\n    }\n\n    public isVisible() {\n        return this.viewElements.popup.isVisible();\n    }\n\n    public applyClinicConfig(clinicConfig: any) {\n        this.viewElements.range.setOptions({\n            stepMinute: clinicConfig.dragTimeStep\n        });\n\n    }\n\n\n    public onDocumentLoaded() {\n\n        this.viewElements.titleInput = <HTMLInputElement>document.getElementById('event-title');\n        this.viewElements.descriptionTextarea = <HTMLTextAreaElement>document.getElementById('event-desc');\n        this.viewElements.patientArrivedButton = <HTMLButtonElement>document.getElementById('event-arrived');\n        this.viewElements.deleteButton = <HTMLButtonElement>document.getElementById('event-delete');\n        this.viewElements.patientCancelledButton = <HTMLButtonElement>document.getElementById('event-cancelled');\n        this.viewElements.patientDNAButton = <HTMLButtonElement>document.getElementById('event-dna');\n        this.viewElements.readyForBillingButton = <HTMLButtonElement>document.getElementById('event-readyforbilling');\n        this.viewElements.billingCompleteButton = <HTMLButtonElement>document.getElementById('event-billingcompleted');\n\n        this.viewElements.patientSearchEl = <HTMLSelectElement>document.getElementById(SELECT.patientSearch);\n        this.viewElements.appointmentTypeEl = <HTMLSelectElement>document.getElementById(SELECT.appointmentType);\n\n        this.viewElements.warningsEl = <HTMLTextAreaElement>document.getElementById(\"patient-warning\");\n\n\n        // @ts-ignore\n        this.viewElements.popup = popup('#add-appointment-popup', {\n            display: 'bottom',\n            contentPadding: true,\n            fullScreen: true,\n            responsive: {\n                medium: {\n                    display: 'anchored',\n                    width: 400,\n                    fullScreen: false,\n                    touchUi: false\n                }\n            }\n        });\n\n        this.viewElements.titleInput.addEventListener('input', function (ev: any) {\n            // update current event's title\n            AppointmentController.getInstance().getModel().tempEvent.title = ev.target.value;\n        });\n\n        this.viewElements.descriptionTextarea.addEventListener('change', function (ev: any) {\n            // update current event's title\n            AppointmentController.getInstance().getModel().tempEvent.description = ev.target.value;\n        });\n\n        this.viewElements.range = datepicker('#event-date', {\n            controls: ['date'],\n            select: 'range',\n            startInput: '#start-input',\n            endInput: '#end-input',\n            showRangeLabels: false,\n            touchUi: true,\n            stepMinute: 15,\n            maxTime: '17:00',\n            responsive: AppointmentDetailModal.datePickerResponsive,\n            onChange: function (args: any) {\n                let date = args.value;\n                // update event's start date\n                AppointmentController.getInstance().getModel().tempEvent.start = date[0];\n                AppointmentController.getInstance().getModel().tempEvent.end = date[1];\n            }\n        });\n\n\n        this.setupActionButtons();\n        logger('Completed setup of detail modal for appointments');\n    }\n\n    public setupAppointmentTypeDropDown(appointmentTypes: any[]) {\n\n        let types: any[] = [];\n\n        appointmentTypes.forEach((type: any) => {\n            if (!(type.isStatus)) types.push(type.name);\n        });\n\n        // add the patient search values to the data of the select dropdown\n        this.viewElements.appointmentTypeDropdown = select('#' + SELECT.appointmentType, {\n            data: types,\n            onChange: (event: any, inst: any) => {\n                // @ts-ignore\n                getInst(AppointmentDetailModal.getInstance().viewElements.descriptionTextarea).value = event.valueText;\n                AppointmentController.getInstance().getModel().tempEvent.type = event.valueText;\n            }\n        });\n    }\n\n    public setupProviderDropdown(providers: any[]) {\n        // add the patient search values to the data of the select dropdown\n        this.viewElements.providersDropdown = select('#event-provider', {\n            data: providers,\n            onChange: (event: any, inst: any) => {\n                AppointmentController.getInstance().getModel().tempEvent.provider = event.valueText;\n                AppointmentController.getInstance().getModel().tempEvent.resource = event.value;\n\n            }\n        });\n\n    }\n\n    public startCreateAppointment(elm: HTMLElement) {\n        // hide delete button inside add popup\n        this.viewElements.deleteButton.style.display = 'none';\n        this.viewElements.patientCancelledButton.style.display = 'none';\n        this.viewElements.patientDNAButton.style.display = 'none';\n        this.viewElements.patientArrivedButton.style.display = 'none';\n        this.viewElements.readyForBillingButton.style.display = 'none';\n        this.viewElements.billingCompleteButton.style.display = 'none';\n        // show the dropdowns\n        this.viewElements.patientSearchEl.style.display = 'block';\n        this.viewElements.appointmentTypeEl.style.display = 'block';\n\n\n        // set popup header text and buttons for adding\n        this.viewElements.popup.setOptions({\n            headerText: 'New event',\n            buttons: [\n                {\n                    text: 'Cancel',\n                    keyCode: 'esc',\n                    handler: function() {\n                        AppointmentTemplateView.getInstance().getCalender().removeEvent(AppointmentTemplateController.getInstance().getModel().tempEvent);\n                    }\n                },\n                {\n                    text: 'Add',\n                    keyCode: 'enter',\n                    handler: function () {\n                        let date = AppointmentDetailModal.getInstance().viewElements.range.getVal();\n                        // store the event created by the UI\n                        let mobiId = AppointmentController.getInstance().getModel().tempEvent.id;\n                        // generate a new UUID\n                        let appointmentId = v4();\n                        // get the colour for the event type\n                        let colour = AppointmentController.getInstance().getColourForAppointmentType('Consulting');\n\n                        let createdOn = parseInt(moment().format('YYYYDDMMHHmmss'));\n\n                        let updatedEvent = {\n                            id: appointmentId,\n                            title: getInst<any>(AppointmentDetailModal.getInstance().viewElements.titleInput).value,\n                            description: getInst<any>(AppointmentDetailModal.getInstance().viewElements.descriptionTextarea).value,\n                            allDay: false,\n                            start: date[0],\n                            end: date[1],\n                            free: false,\n                            color: colour,\n                            patientId: AppointmentController.getInstance().getModel().tempEvent.patientId,\n                            editable: true,\n                            resource: AppointmentController.getInstance().getModel().tempEvent.resource,\n                            isDNA: false,\n                            isCancelled: false,\n                            createdBy: SecurityManager.getInstance().getLoggedInUsername(),\n                            created: createdOn,\n                            modified: createdOn,\n                            arrivalTime: '',\n                            type: AppointmentController.getInstance().getModel().tempEvent.type,\n                            provider: AppointmentController.getInstance().getModel().tempEvent.provider\n                        };\n                        logger('inserting');\n                        logger(updatedEvent);\n\n                        // remove the original event\n                        AppointmentBookView.getInstance().getCalender().removeEvent([mobiId]);\n                        AppointmentBookView.getInstance().getCalender().addEvent(updatedEvent);\n                        Controller.getInstance().getStateManager().addNewItemToState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(updatedEvent),\n                            false);\n\n                        // navigate the calendar to the correct view\n                        AppointmentBookView.getInstance().getCalender().navigate(updatedEvent.start);\n                        AppointmentDetailModal.getInstance().close();\n                    },\n                    cssClass: 'mbsc-popup-button-primary'\n                }\n            ]\n        });\n\n        // fill popup with a new event data\n\n        // @ts-ignore\n        mobiscroll5.getInst(this.viewElements.titleInput).value = AppointmentController.getInstance().getModel().tempEvent.title;\n        // @ts-ignore\n        mobiscroll5.getInst(this.viewElements.descriptionTextarea).value = '';\n\n        this.viewElements.range.setVal([AppointmentController.getInstance().getModel().tempEvent.start, AppointmentController.getInstance().getModel().tempEvent.end]);\n        this.viewElements.range.setOptions({\n            controls: AppointmentController.getInstance().getModel().tempEvent.allDay ? ['date'] : ['datetime'],\n            responsive: AppointmentController.getInstance().getModel().tempEvent.allDay ? AppointmentDetailModal.datePickerResponsive : AppointmentDetailModal.datetimePickerResponsive\n        });\n\n        this.viewElements.appointmentTypeDropdown.setVal('');\n        this.viewElements.patientSearchDropdown.setVal('');\n        this.viewElements.providersDropdown.setVal(AppointmentController.getInstance().getModel().tempEvent.resource);\n\n        // set anchor for the popup\n        this.viewElements.popup.setOptions({anchor: elm});\n\n        this.viewElements.popup.open();\n    }\n\n    public updateAppointment(args: any) {\n        let ev = args.event;\n\n        // show delete button inside edit popup\n        this.viewElements.patientArrivedButton.style.display = 'block';\n        this.viewElements.deleteButton.style.display = 'block';\n        this.viewElements.patientCancelledButton.style.display = 'block';\n        this.viewElements.patientDNAButton.style.display = 'block';\n        this.viewElements.readyForBillingButton.style.display = 'block';\n        this.viewElements.billingCompleteButton.style.display = 'block';\n        // show the dropdowns\n        this.viewElements.patientSearchEl.style.display = 'none';\n        this.viewElements.appointmentTypeEl.style.display = 'none';\n\n\n        // set popup header text and buttons for editing\n        this.viewElements.popup.setOptions({\n            headerText: 'Edit event',\n            buttons: [\n                {\n                    text: 'Cancel',\n                    keyCode: 'esc',\n                    handler: function() {\n                        AppointmentTemplateView.getInstance().getCalender().updateEvent(AppointmentTemplateController.getInstance().getModel().oldEvent);\n                    }\n                },\n                {\n                    text: 'Save',\n                    keyCode: 'enter',\n                    handler: function () {\n                        let date = AppointmentDetailModal.getInstance().viewElements.range.getVal();\n                        // update event with the new properties on save button click\n                        let createdOn = parseInt(moment().format('YYYYDDMMHHmmss'));\n                        //\n                        let updatedEvent = {\n                            id: ev.id,\n                            title: getInst<any>(AppointmentDetailModal.getInstance().viewElements.titleInput).value,\n                            description: getInst<any>(AppointmentDetailModal.getInstance().viewElements.descriptionTextarea).value,\n                            allDay: false,\n                            start: date[0],\n                            end: date[1],\n                            free: false,\n                            patientId: ev.patientId,\n                            editable: true,\n                            resource: ev.resource,\n                            isDNA: ev.isDNA,\n                            isCancelled: ev.isCancelled,\n                            createdBy: SecurityManager.getInstance().getLoggedInUsername(),\n                            created: ev.created,\n                            modified: createdOn,\n                            arrivalTime: '',\n                            type: ev.type,\n                            provider: ev.provider\n                        };\n                        // @ts-ignore\n                        updatedEvent.color = AppointmentController.getInstance().getColourForAppointment(updatedEvent);\n                        logger('updated');\n                        logger(updatedEvent)\n                        AppointmentBookView.getInstance().getCalender().updateEvent(updatedEvent);\n                        Controller.getInstance().getStateManager().updateItemInState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(updatedEvent),\n                            false);\n                        // navigate the calendar to the correct view\n\n                        AppointmentBookView.getInstance().getCalender().navigate(date[0]);\n                        AppointmentDetailModal.getInstance().close();\n                    },\n                    cssClass: 'mbsc-popup-button-primary'\n                }\n            ]\n        });\n\n        // fill popup with the selected event data\n        // @ts-ignore\n        mobiscroll5.getInst(this.viewElements.titleInput).value = ev.title || '';\n        // @ts-ignore\n        mobiscroll5.getInst(this.viewElements.descriptionTextarea).value = ev.description || '';\n        this.viewElements.range.setVal([ev.start, ev.end]);\n\n        // change range settings based on the allDay\n        this.viewElements.range.setOptions({\n            controls: ev.allDay ? ['date'] : ['datetime'],\n            responsive: ev.allDay ? AppointmentDetailModal.datePickerResponsive : AppointmentDetailModal.datetimePickerResponsive\n        });\n\n        // set the appointment type and patient\n        this.viewElements.appointmentTypeDropdown.setVal(ev.type);\n        this.viewElements.patientSearchDropdown.setVal(ev.patientId);\n        this.viewElements.providersDropdown.setVal(ev.resource);\n\n        let warningsText = this.getPatientWarnings(ev.patientId);\n        // @ts-ignore\n        mobiscroll5.getInst(AppointmentDetailModal.getInstance().viewElements.warningsEl).value = warningsText;\n\n        // set anchor for the popup\n        this.viewElements.popup.setOptions({anchor: args.domEvent.currentTarget});\n        this.viewElements.popup.open();\n    }\n\n    protected setupActionButtons() {\n        this.viewElements.deleteButton.addEventListener('click', function () {\n            // delete current event on button click\n            //\n            AppointmentBookView.getInstance().getCalender().removeEvent(AppointmentController.getInstance().getModel().tempEvent);\n            Controller.getInstance().getStateManager().removeItemFromState(\n                STATE_NAMES.appointments,\n                AppointmentController.getInstance().getAppointmentFromEvent(AppointmentController.getInstance().getModel().tempEvent),\n                false);\n\n            AppointmentDetailModal.getInstance().close();\n\n            // save a local reference to the deleted event\n            let deletedEvent = AppointmentController.getInstance().getModel().tempEvent;\n\n            //\n            snackbar({\n                button: {\n                    action: function () {\n                        //\n                        AppointmentBookView.getInstance().getCalender().addEvent(deletedEvent);\n                        Controller.getInstance().getStateManager().addNewItemToState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(deletedEvent),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Event deleted'\n            });\n        });\n\n        this.viewElements.patientCancelledButton.addEventListener('click', function () {\n            // update the event to cancelled and set to non-editable\n            // save a local reference to the deleted event\n            let originalEvent = AppointmentController.getInstance().getModel().tempEvent;\n\n            let originalType = originalEvent.type;\n            let originalNote = originalEvent.note;\n\n            originalEvent.isCancelled = true;\n            originalEvent.type = AppointmentController.APPOINTMENT_TYPE_PATIENT_CANCELLED;\n            originalEvent.note = AppointmentController.APPOINTMENT_TYPE_PATIENT_CANCELLED;\n            originalEvent.editable = false;\n            originalEvent.color = AppointmentController.getInstance().getColourForAppointmentType(AppointmentController.APPOINTMENT_TYPE_PATIENT_CANCELLED);\n\n            //\n            AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n            Controller.getInstance().getStateManager().updateItemInState(\n                STATE_NAMES.appointments,\n                AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                false);\n\n            AppointmentDetailModal.getInstance().close();\n\n\n            //\n            snackbar({\n                button: {\n                    action: function () {\n                        originalEvent.isCancelled = false;\n                        originalEvent.type = originalType;\n                        originalEvent.note = originalNote;\n                        originalEvent.editable = true;\n                        originalEvent.color = AppointmentController.getInstance().getColourForAppointment(originalEvent);\n                        AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n                        Controller.getInstance().getStateManager().updateItemInState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Patient Cancelled'\n            });\n        });\n\n        this.viewElements.patientArrivedButton.addEventListener('click', function () {\n            // update the event to arrived\n            // save a local reference to the deleted event\n            let originalEvent = AppointmentController.getInstance().getModel().tempEvent;\n\n            originalEvent.arrivalTime = moment().format('HHmmss');\n            originalEvent.color = AppointmentController.getInstance().getColourForAppointment(originalEvent);\n\n            AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n            Controller.getInstance().getStateManager().updateItemInState(\n                STATE_NAMES.appointments,\n                AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                false);\n\n            AppointmentDetailModal.getInstance().close();\n\n\n            //\n            snackbar({\n                button: {\n                    action: function () {\n                        originalEvent.arrivalTime = '';\n                        originalEvent.color = AppointmentController.getInstance().getColourForAppointment(originalEvent);\n                        AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n                        Controller.getInstance().getStateManager().updateItemInState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Patient Arrived'\n            });\n        });\n\n        this.viewElements.patientDNAButton.addEventListener('click', function () {\n            // update the event to cancelled and set to non-editable\n            // save a local reference to the deleted event\n            let originalEvent = AppointmentController.getInstance().getModel().tempEvent;\n            let originalNote = originalEvent.note;\n            let originalType = originalEvent.type;\n\n            originalEvent.isDNA = true;\n            originalEvent.type = AppointmentController.APPOINTMENT_TYPE_PATIENT_DNA;\n            originalEvent.note = AppointmentController.APPOINTMENT_TYPE_PATIENT_DNA;\n            originalEvent.editable = false;\n            originalEvent.color = AppointmentController.getInstance().getColourForAppointmentType(AppointmentController.APPOINTMENT_TYPE_PATIENT_DNA);\n\n            //\n            AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n            Controller.getInstance().getStateManager().updateItemInState(\n                STATE_NAMES.appointments,\n                AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                false);\n\n            AppointmentDetailModal.getInstance().close();\n\n            snackbar({\n                button: {\n                    action: function () {\n                        originalEvent.isDNA = false;\n                        originalEvent.type = originalType;\n                        originalEvent.note = originalNote;\n                        originalEvent.editable = true;\n                        originalEvent.color = AppointmentController.getInstance().getColourForAppointment(originalEvent);\n                        AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n                        Controller.getInstance().getStateManager().updateItemInState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Patient DNA'\n            });\n        });\n        this.viewElements.readyForBillingButton.addEventListener('click', function () {\n            // update the event to cancelled and set to non-editable\n            // save a local reference to the deleted event\n            let originalEvent = AppointmentController.getInstance().getModel().tempEvent;\n\n\n            originalEvent.readyForBilling = true;\n            originalEvent.color = AppointmentController.getInstance().getColourForAppointmentType(AppointmentController.APPOINTMENT_STATUS_READY_FOR_BILLING);\n\n            //\n            AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n            Controller.getInstance().getStateManager().updateItemInState(\n                STATE_NAMES.appointments,\n                AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                false);\n\n            AppointmentDetailModal.getInstance().close();\n\n            snackbar({\n                button: {\n                    action: function () {\n                        originalEvent.readyForBilling = false;\n                        originalEvent.color = AppointmentController.getInstance().getColourForAppointment(originalEvent);\n                        AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n                        Controller.getInstance().getStateManager().updateItemInState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Ready For Billing'\n            });\n        });\n        this.viewElements.billingCompleteButton.addEventListener('click', function () {\n            // update the event to cancelled and set to non-editable\n            // save a local reference to the deleted event\n            let originalEvent = AppointmentController.getInstance().getModel().tempEvent;\n\n\n            originalEvent.isBilled = true;\n            originalEvent.editable = false;\n            originalEvent.color = AppointmentController.getInstance().getColourForAppointmentType(AppointmentController.APPOINTMENT_STATUS_BILLING_COMPLETE);\n\n            //\n            AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n            Controller.getInstance().getStateManager().updateItemInState(\n                STATE_NAMES.appointments,\n                AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                false);\n\n            AppointmentDetailModal.getInstance().close();\n\n            snackbar({\n                button: {\n                    action: function () {\n                        originalEvent.isBilled = false;\n                        originalEvent.editable = true;\n                        originalEvent.color = AppointmentController.getInstance().getColourForAppointment(originalEvent);\n                        AppointmentBookView.getInstance().getCalender().updateEvent(originalEvent);\n                        Controller.getInstance().getStateManager().updateItemInState(\n                            STATE_NAMES.appointments,\n                            AppointmentController.getInstance().getAppointmentFromEvent(originalEvent),\n                            false);\n                    },\n                    text: 'Undo'\n                },\n                message: 'Billing Complete'\n            });\n        });\n    }\n\n    private getPatientWarnings(patientId:string) {\n        let patientBasicDetails: any = Controller.getInstance().getStateManager().findItemInState(STATE_NAMES.patientSearch, {_id: patientId});\n        let warningsText = '';\n        if (patientBasicDetails && patientBasicDetails.flags) {\n            if (patientBasicDetails.flags.hasWarnings) {\n                patientBasicDetails.warnings.warnings.forEach((warning: any) => {\n                    warningsText += warning + '\\r\\n';\n                });\n                logger('Patient has warnings');\n                logger(patientBasicDetails);\n                logger(warningsText);\n            }\n\n        }\n        return warningsText;\n\n    }\n\n    public setupPatientSearchDropDown(patientsCollection: any[]) {\n        this.patients = [];\n\n        patientsCollection.forEach((patient: any) => {\n            this.patients.push({text: `${patient.name.surname}, ${patient.name.firstname}`, value: patient._id});\n        });\n\n        // add the patient search values to the data of the select dropdown\n        //\n        this.viewElements.patientSearchDropdown = select('#' + SELECT.patientSearch, {\n            filter: true,\n            data: AppointmentDetailModal.getInstance().patients,\n            onChange: (event: any, inst: any) => {\n                // @ts-ignore\n                getInst(AppointmentDetailModal.getInstance().viewElements.titleInput).value = event.valueText;\n\n                let warningsText = this.getPatientWarnings(event.value);\n                // @ts-ignore\n                getInst(AppointmentDetailModal.getInstance().viewElements.warningsEl).value = warningsText;\n\n                AppointmentController.getInstance().getModel().tempEvent.patientId = event.value;\n                AppointmentController.getInstance().getModel().tempEvent.warnings = warningsText;\n            }\n        });\n\n    }\n\n\n}\n","import {AppointmentBookView} from \"./AppointmentBookView\";\nimport {AppointmentController} from \"./AppointmentController\";\nimport App from \"../App\";\nimport moment from \"moment\";\n\nexport class AppointmentFilterView {\n    private static _instance: AppointmentFilterView;\n\n    public static getInstance(): AppointmentFilterView {\n        if (!(AppointmentFilterView._instance)) {\n            AppointmentFilterView._instance = new AppointmentFilterView();\n        }\n        return AppointmentFilterView._instance;\n    }\n\n    private providersEl: HTMLDivElement|null;\n    private calendarFilterEl : HTMLDivElement|null;\n\n    public onDocumentLoaded() {\n        this.providersEl = <HTMLDivElement>document.getElementById('providers');\n        this.calendarFilterEl = <HTMLDivElement>document.getElementById('calendarFilter');\n    }\n\n    public populateProviders(providers:any[]): void {\n        if (providers && this.providersEl) {\n            providers.forEach((provider:any) => {\n                let labelEl = document.createElement('label');\n                let inputEl = document.createElement('input');\n                inputEl.setAttribute('type','checkbox');\n                inputEl.setAttribute('value',provider.name);\n                inputEl.setAttribute(\"checked\",'');\n                inputEl.setAttribute(\"mbsc-checkbox\",'');\n                inputEl.setAttribute('data-label',provider.name);\n                inputEl.classList.add('provider-checkbox');\n                labelEl.appendChild(inputEl);\n\n                this.providersEl.appendChild(labelEl);\n\n\n            });\n            // @ts-ignore\n            mobiscroll5.enhance(this.providersEl);\n            // @ts-ignore\n            mobiscroll5.enhance(this.calendarFilterEl);\n\n\n            document.querySelectorAll('.provider-checkbox').forEach(function (elm) {\n                elm.addEventListener('change', function () {\n                    let checkboxList = document.querySelectorAll('.provider-checkbox');\n                    let selected:any[] = [];\n\n                    for (let i = 0; i < checkboxList.length; i++) {\n                        let checkbox = checkboxList[i];\n                        // @ts-ignore\n                        if (checkbox.checked) {\n                            // @ts-ignore\n                            selected.push({id:checkbox.value,name:checkbox.value});\n                        }\n                    }\n\n\n\n                     AppointmentBookView.getInstance().getCalender().setOptions({\n                        resources: selected\n                     });\n                });\n            });\n\n            // document.querySelectorAll('.md-view-change').forEach(function (elm) {\n            //     elm.addEventListener('change', function (ev) {\n            //\n            //         let config = {...AppointmentTemplateController.getInstance().getModel().clinicConfig};\n            //          config.view.schedule.type = ev.target.value;\n            //\n            //         let options = {\n            //             //clickToCreate: config.clickToCreate,\n            //             //dragTimeStep: config.dragTimeStep,\n            //             //dragToCreate: config.dragToCreate,\n            //             //dragToMove: config.dragToMove,\n            //             //dragToResize: config.dragToResize,\n            //             //min: moment().subtract(config.min, \"months\"),\n            //             //controls: config.controls,\n            //             //showControls: config.showControls,\n            //             view: {\n            //                 schedule: {\n            //                     type: ev.target.value,\n            //                     startTime: config.view.schedule.startTime,\n            //                     endTime: config.view.schedule.endTime,\n            //                     timeCellStep:10,\n            //                     timeLabelStep:60\n            //                 }\n            //             },\n            //             //invalidateEvent: config.invalidateEvent,\n            //             //invalid: config.invalid,\n            //         }\n            //\n            //         console.log(options);\n            //\n            //         AppointmentTemplateView.getInstance().getCalender().setOptions(options);\n            //\n            //     });\n            // });\n\n\n        }\n\n    }\n\n}\n","import {PatientSearchSidebarContainers, PatientSearchSidebarPrefs} from \"../AppTypes\";\nimport {SidebarViewContainer, StateManager} from \"ui-framework-jps\";\nimport {PatientSearchView} from \"./PatientSearchView\";\nimport Controller from \"../Controller\";\n\nexport class PatientSearchSidebar extends SidebarViewContainer {\n\n    private static _instance: PatientSearchSidebar;\n\n    public static getInstance(): PatientSearchSidebar {\n        if (!(PatientSearchSidebar._instance)) {\n            PatientSearchSidebar._instance = new PatientSearchSidebar();\n        }\n        return PatientSearchSidebar._instance;\n    }\n\n\n    private constructor() {\n        super(PatientSearchSidebarPrefs);\n        const recentSearches = new PatientSearchView(Controller.getInstance().getStateManager());\n        this.addView(recentSearches, {containerId: PatientSearchSidebarContainers.container});\n    }\n}\n\n\n","import debug from 'debug';\nimport {\n    AbstractStatefulCollectionView,\n    BrowserStorageStateManager,\n    CollectionViewDOMConfig,\n    KeyType,\n    ListViewRenderer,\n    Modifier,\n    StateManager,\n    View\n} from \"ui-framework-jps\";\nimport {DRAGGABLE, STATE_NAMES, VIEW_NAME} from \"../AppTypes\";\nimport {isSameMongo} from \"../EqualityFunctions\";\nimport Controller from \"../Controller\";\n\n\nconst vLogger = debug('patient-search');\nconst vLoggerDetail = debug('patient-search-detail');\n\nexport class PatientSearchView extends AbstractStatefulCollectionView  {\n    static fastSearchInputId: string = 'fastPatientSearch';\n    static dataLimit: number = 20;\n    static DOMConfig: CollectionViewDOMConfig = {\n        viewConfig: {\n            resultsContainerId: 'recentPatientSearches',\n            dataSourceId: VIEW_NAME.patientSearch,\n        },\n        resultsElementType: 'a',\n        resultsElementAttributes: [{name: 'href', value: '#'}],\n        resultsClasses: 'list-group-item my-list-item truncate-notification list-group-item-action',\n        keyId: '_id',\n        keyType: KeyType.string,\n        modifiers: {\n            normal: 'list-group-item-primary',\n            inactive: 'list-group-item-light',\n            active: 'list-group-item-info',\n            warning: 'list-group-item-danger'\n        },\n        icons: {\n            normal: '',\n            inactive: '',\n            active: '',\n            warning: 'fas fa-exclamation-circle'\n        },\n        detail: {\n            containerClasses: 'd-flex w-100 justify-content-between',\n            textElementType: 'span',\n            textElementClasses: 'mb-1',\n            select: true,\n            quickDelete: true,\n            delete: {\n                buttonClasses: 'btn bg-danger text-white btn-circle btn-sm',\n                iconClasses: 'fas fa-trash-alt',\n            },\n            drag: {\n                type: DRAGGABLE.typePatientSummary,\n                from: DRAGGABLE.fromPatientSearch\n            },\n        },\n    };\n    protected loggedInUsers: string[];\n    protected localisedSM: StateManager;\n\n    constructor(stateManager: StateManager) {\n        super(PatientSearchView.DOMConfig, stateManager, STATE_NAMES.patientSearch);\n\n        this.loggedInUsers = [];\n\n        this.renderer = new ListViewRenderer(this, this);\n\n\n        // handler binding\n        this.updateViewForNamedCollection = this.updateViewForNamedCollection.bind(this);\n        this.eventPatientSelected = this.eventPatientSelected.bind(this);\n        this.itemDeleted = this.itemDeleted.bind(this);\n\n        // register state change listening\n        this.localisedSM = new BrowserStorageStateManager(true,true,isSameMongo);\n        this.localisedSM.addChangeListenerForName(STATE_NAMES.recentPatientSearches, this);\n\n    }\n\n\n\n    onDocumentLoaded() {\n        super.onDocumentLoaded();\n        // @ts-ignore\n        const fastSearchEl = $(`#${PatientSearchView.fastSearchInputId}`);\n        // @ts-ignore\n        fastSearchEl.on('autocompleteselect', this.eventPatientSelected);\n\n        super.updateViewForNamedCollection(STATE_NAMES.patientSearch, this.localisedSM.getStateByName(STATE_NAMES.recentPatientSearches));\n\n    }\n\n    getIdForItemInNamedCollection(name: string, item: any) {\n        return item._id;\n    }\n\n\n    renderDisplayForItemInNamedCollection(containerEl: HTMLElement, name: string, item: any): void {\n        containerEl.innerHTML = `${item.name.firstname} ${item.name.surname}`;\n    }\n\n    getModifierForItemInNamedCollection(name: string, item: any) {\n        let result = Modifier.normal;\n        vLoggerDetail(`Checking for item modifiers`);\n        vLoggerDetail(item);\n        if (item.flags.isInactive) result = Modifier.inactive;\n        return result;\n    }\n\n    getSecondaryModifierForItemInNamedCollection(name: string, item: any): Modifier {\n        let result = Modifier.normal;\n        if (item.flags.hasWarnings) result = Modifier.warning;\n        return result;\n\n    }\n\n\n    eventPatientSelected(event: Event, ui: any) {\n        event.preventDefault();\n        event.stopPropagation();\n        vLogger(`User ${ui.item.label} with id ${ui.item.value} selected`);\n        // @ts-ignore\n        event.target.innerText = '';\n\n        // add the selected user to the recent user searches\n        if (this.localisedSM.isItemInState(STATE_NAMES.recentPatientSearches, {_id: ui.item.value})) return;\n\n        const recentUserSearches = this.localisedSM.getStateByName(STATE_NAMES.recentPatientSearches);\n        vLogger(`saved searches too long? ${STATE_NAMES.recentPatientSearches}`);\n        if (recentUserSearches.length >= PatientSearchView.dataLimit) {\n            vLogger('saved searches too long - removing first');\n            // remove the first item from recent searches\n            const item = recentUserSearches.shift();\n            this.localisedSM.removeItemFromState(STATE_NAMES.recentPatientSearches, item, true);\n        }\n\n        const patient = Controller.getInstance().getStateManager().findItemInState(STATE_NAMES.patientSearch,{_id:ui.item.value});\n        // save the searches\n        this.localisedSM.addNewItemToState(STATE_NAMES.recentPatientSearches, patient, true);\n    }\n\n\n    updateViewForNamedCollection(name: string, newState: any) {\n        if (name === STATE_NAMES.recentPatientSearches) {\n            vLogger(`Updating for recent searches`);\n            newState = this.localisedSM.getStateByName(STATE_NAMES.recentPatientSearches);\n            vLogger(newState);\n            super.updateViewForNamedCollection(name, newState);\n        }\n        if (name === STATE_NAMES.patientSearch) {\n            vLogger(`Handling patient search results`);\n            vLogger(newState);\n            // load the search names into the search field\n            const fastSearchEl = $(`#${PatientSearchView.fastSearchInputId}`);\n            // for each name, construct the patient details to display and the id referenced\n            const fastSearchValues: any = [];\n            newState.forEach((item: any) => {\n                const searchValue = {\n                    label: `${item.name.firstname} ${item.name.surname}`,\n                    value: item._id,\n                };\n                fastSearchValues.push(searchValue);\n            });\n            fastSearchEl.autocomplete({source: fastSearchValues});\n            fastSearchEl.autocomplete('option', {disabled: false, minLength: 1});\n        }\n    }\n\n\n\n    compareItemsForEquality(item1: any, item2: any): boolean {\n        return isSameMongo(item1, item2);\n    }\n\n    itemDeleted(view: View, selectedItem: any): void {\n        vLoggerDetail(selectedItem);\n        vLogger(`Recent search patient ${selectedItem.firstname} with id ${selectedItem.id} deleted - removing`);\n        this.localisedSM.removeItemFromState(STATE_NAMES.recentPatientSearches, selectedItem, true);\n    }\n\n\n\n\n\n}\n\n","import debug from 'debug';\nimport Controller from './Controller';\n\nimport {\n    API_Config,\n    NAVIGATION, STATE_NAMES,\n} from \"./AppTypes\";\nimport React, {ReactNode} from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {AppointmentController} from \"./appointments/AppointmentController\";\nimport {\n    ChatRoomsSidebar,\n    ContextualInformationHelper,\n    SecurityManager,\n    UnreadMessageCountListener\n} from \"ui-framework-jps\";\nimport {setOptions} from \"@mobiscroll/javascript\";\nimport {AppointmentTemplateController} from \"./appointment-templates/AppointmentTemplateController\";\nimport browserUtil from \"ui-framework-jps/dist/framework/util/BrowserUtil\";\nimport {PatientSearchSidebar} from \"./patients/PatientSearchSidebar\";\nimport {PatientSearchView} from \"./patients/PatientSearchView\";\n\n\n\n\n\n\nconst logger = debug('app');\n\nexport default class App extends React.Component implements UnreadMessageCountListener {\n\n\n    // @ts-ignore\n    private chatSidebar: ChatRoomsSidebar;\n\n    // @ts-ignore\n    private chatView: ChatLogsView;\n\n    private thisEl: HTMLDivElement | null = null;\n    private chatNavigationItem: HTMLAnchorElement | null = null;\n\n\n\n    public constructor() {\n        // @ts-ignore\n        super();\n        // event handlers\n        this.handleShowChat = this.handleShowChat.bind(this);\n        this.handleShowAppointmentBook = this.handleShowAppointmentBook.bind(this);\n        this.handleShowAppointmentTemplates = this.handleShowAppointmentTemplates.bind(this);\n        this.handleShowPatientRecords = this.handleShowPatientRecords.bind(this);\n        this.handleShowPatientSearch = this.handleShowPatientSearch.bind(this);\n\n        Controller.getInstance().connectToApplication(this, window.localStorage);\n    }\n\n    render(): ReactNode {\n        logger(\"Rendering App\");\n        return (\n            <div></div>\n        )\n    }\n\n\n\n\n    componentDidMount(): void {\n        logger('component Did Mount');\n        logger('document loaded');\n        // @ts-ignore\n        this.thisEl = document.getElementById('root');\n\n        PatientSearchSidebar.getInstance().onDocumentLoaded();\n\n        this.setupNavigationItemHandling();\n\n        AppointmentController.getInstance().onDocumentLoaded();\n        AppointmentTemplateController.getInstance().onDocumentLoaded();\n        ContextualInformationHelper.getInstance().onDocumentLoaded();\n        SecurityManager.getInstance().onDocumentLoaded(NAVIGATION.logout);\n        Controller.getInstance().onDocumentLoaded();\n\n        Controller.getInstance().getStateManager().findItemInState(STATE_NAMES.patients,{_id:'2a8665a6-3580-4195-8ed7-0f81df551204'});\n\n    }\n\n    getCurrentUser() {\n        return Controller.getInstance().getLoggedInUserId();\n    }\n\n    hideAllSideBars() {\n        this.chatSidebar.eventHide(null);\n        PatientSearchSidebar.getInstance().eventHide(null);\n    }\n\n\n\n    handleShowChat(roomName: string | null) {\n        logger('Handling Show Chat');\n        // prevent anything from happening if we are not logged in\n        if (!Controller.getInstance().isLoggedIn()) {\n            // @ts-ignore\n            window.location.href = API_Config.login;\n            return;\n        }\n        this.chatSidebar.eventShow(null);\n        if (roomName) {\n            this.chatView.selectChatRoom(roomName);\n        }\n    }\n\n    countChanged(newCount: number): void {\n        //\n        let buffer = 'Chat <i class=\"fas fa-inbox\"></i>';\n        if (newCount > 0) {\n            buffer += ` <span class=\"badge badge-pill badge-primary\">&nbsp;${newCount}&nbsp;</span>`;\n        }\n        if (this.chatNavigationItem) this.chatNavigationItem.innerHTML = `${buffer}`;\n    }\n\n    protected handleShowAppointmentBook(event:Event):void {\n        logger(`Showing appointment book`);\n        logger(AppointmentController.getInstance().getModel().clinicConfig);\n        browserUtil.addRemoveClasses(document.getElementById('appointmentBook'),'d-none',false);\n        browserUtil.addRemoveClasses(document.getElementById('appointmentTemplates'),'d-none',true);\n\n\n    }\n    protected handleShowAppointmentTemplates(event:Event):void {\n        logger(`Showing appointment templates`);\n        logger(AppointmentController.getInstance().getModel().clinicConfig);\n        browserUtil.addRemoveClasses(document.getElementById('appointmentBook'),'d-none',true);\n        browserUtil.addRemoveClasses(document.getElementById('appointmentTemplates'),'d-none',false);\n\n    }\n    protected handleShowPatientRecords(event:Event):void {\n\n    }\n    protected handleShowPatientSearch(event:Event):void {\n        logger(`Showing patient search`);\n        PatientSearchSidebar.getInstance().eventShow(null);\n\n    }\n\n\n    private setupNavigationItemHandling() {\n        document.getElementById(NAVIGATION.appointmentBook).addEventListener('click', this.handleShowAppointmentBook);\n        let templateEl = document.getElementById(NAVIGATION.appointmentTemplates);\n        if (templateEl) {\n            templateEl.addEventListener('click', this.handleShowAppointmentTemplates);\n        }\n        document.getElementById(NAVIGATION.patientRecords).addEventListener('click',this.handleShowPatientRecords);\n        document.getElementById(NAVIGATION.patientSearch).addEventListener('click',this.handleShowPatientSearch);\n\n\n        // @ts-ignore\n        this.chatNavigationItem = document.getElementById(NAVIGATION.clinicChat);\n\n        // @ts-ignore\n        this.chatNavigationItem.addEventListener('click', this.handleShowChat);\n    }\n\n\n}\n\nlocalStorage.debug = 'app api-ts-results api-ts state-manager-api';\nlocalStorage.plugin = 'chat';\n\ndebug.log = console.info.bind(console);\n\n$(function () {\n\n    setOptions({\n        theme: 'ios',\n        themeVariant: 'light'\n    });\n\n    // @ts-ignore\n    mobiscroll5.setOptions({\n        theme: 'ios',\n        themeVariant: 'light'\n    });\n\n    // @ts-ignore\n    const element = <App className=\"container-fluid justify-content-around\"/>;\n    ReactDOM.render(element, document.getElementById('root'));\n\n});\n","var map = {\n\t\"./af\": \"./node_modules/moment/locale/af.js\",\n\t\"./af.js\": \"./node_modules/moment/locale/af.js\",\n\t\"./ar\": \"./node_modules/moment/locale/ar.js\",\n\t\"./ar-dz\": \"./node_modules/moment/locale/ar-dz.js\",\n\t\"./ar-dz.js\": \"./node_modules/moment/locale/ar-dz.js\",\n\t\"./ar-kw\": \"./node_modules/moment/locale/ar-kw.js\",\n\t\"./ar-kw.js\": \"./node_modules/moment/locale/ar-kw.js\",\n\t\"./ar-ly\": \"./node_modules/moment/locale/ar-ly.js\",\n\t\"./ar-ly.js\": \"./node_modules/moment/locale/ar-ly.js\",\n\t\"./ar-ma\": \"./node_modules/moment/locale/ar-ma.js\",\n\t\"./ar-ma.js\": \"./node_modules/moment/locale/ar-ma.js\",\n\t\"./ar-sa\": \"./node_modules/moment/locale/ar-sa.js\",\n\t\"./ar-sa.js\": \"./node_modules/moment/locale/ar-sa.js\",\n\t\"./ar-tn\": \"./node_modules/moment/locale/ar-tn.js\",\n\t\"./ar-tn.js\": \"./node_modules/moment/locale/ar-tn.js\",\n\t\"./ar.js\": \"./node_modules/moment/locale/ar.js\",\n\t\"./az\": \"./node_modules/moment/locale/az.js\",\n\t\"./az.js\": \"./node_modules/moment/locale/az.js\",\n\t\"./be\": \"./node_modules/moment/locale/be.js\",\n\t\"./be.js\": \"./node_modules/moment/locale/be.js\",\n\t\"./bg\": \"./node_modules/moment/locale/bg.js\",\n\t\"./bg.js\": \"./node_modules/moment/locale/bg.js\",\n\t\"./bm\": \"./node_modules/moment/locale/bm.js\",\n\t\"./bm.js\": \"./node_modules/moment/locale/bm.js\",\n\t\"./bn\": \"./node_modules/moment/locale/bn.js\",\n\t\"./bn-bd\": \"./node_modules/moment/locale/bn-bd.js\",\n\t\"./bn-bd.js\": \"./node_modules/moment/locale/bn-bd.js\",\n\t\"./bn.js\": \"./node_modules/moment/locale/bn.js\",\n\t\"./bo\": \"./node_modules/moment/locale/bo.js\",\n\t\"./bo.js\": \"./node_modules/moment/locale/bo.js\",\n\t\"./br\": \"./node_modules/moment/locale/br.js\",\n\t\"./br.js\": \"./node_modules/moment/locale/br.js\",\n\t\"./bs\": \"./node_modules/moment/locale/bs.js\",\n\t\"./bs.js\": \"./node_modules/moment/locale/bs.js\",\n\t\"./ca\": \"./node_modules/moment/locale/ca.js\",\n\t\"./ca.js\": \"./node_modules/moment/locale/ca.js\",\n\t\"./cs\": \"./node_modules/moment/locale/cs.js\",\n\t\"./cs.js\": \"./node_modules/moment/locale/cs.js\",\n\t\"./cv\": \"./node_modules/moment/locale/cv.js\",\n\t\"./cv.js\": \"./node_modules/moment/locale/cv.js\",\n\t\"./cy\": \"./node_modules/moment/locale/cy.js\",\n\t\"./cy.js\": \"./node_modules/moment/locale/cy.js\",\n\t\"./da\": \"./node_modules/moment/locale/da.js\",\n\t\"./da.js\": \"./node_modules/moment/locale/da.js\",\n\t\"./de\": \"./node_modules/moment/locale/de.js\",\n\t\"./de-at\": \"./node_modules/moment/locale/de-at.js\",\n\t\"./de-at.js\": \"./node_modules/moment/locale/de-at.js\",\n\t\"./de-ch\": \"./node_modules/moment/locale/de-ch.js\",\n\t\"./de-ch.js\": \"./node_modules/moment/locale/de-ch.js\",\n\t\"./de.js\": \"./node_modules/moment/locale/de.js\",\n\t\"./dv\": \"./node_modules/moment/locale/dv.js\",\n\t\"./dv.js\": \"./node_modules/moment/locale/dv.js\",\n\t\"./el\": \"./node_modules/moment/locale/el.js\",\n\t\"./el.js\": \"./node_modules/moment/locale/el.js\",\n\t\"./en-au\": \"./node_modules/moment/locale/en-au.js\",\n\t\"./en-au.js\": \"./node_modules/moment/locale/en-au.js\",\n\t\"./en-ca\": \"./node_modules/moment/locale/en-ca.js\",\n\t\"./en-ca.js\": \"./node_modules/moment/locale/en-ca.js\",\n\t\"./en-gb\": \"./node_modules/moment/locale/en-gb.js\",\n\t\"./en-gb.js\": \"./node_modules/moment/locale/en-gb.js\",\n\t\"./en-ie\": \"./node_modules/moment/locale/en-ie.js\",\n\t\"./en-ie.js\": \"./node_modules/moment/locale/en-ie.js\",\n\t\"./en-il\": \"./node_modules/moment/locale/en-il.js\",\n\t\"./en-il.js\": \"./node_modules/moment/locale/en-il.js\",\n\t\"./en-in\": \"./node_modules/moment/locale/en-in.js\",\n\t\"./en-in.js\": \"./node_modules/moment/locale/en-in.js\",\n\t\"./en-nz\": \"./node_modules/moment/locale/en-nz.js\",\n\t\"./en-nz.js\": \"./node_modules/moment/locale/en-nz.js\",\n\t\"./en-sg\": \"./node_modules/moment/locale/en-sg.js\",\n\t\"./en-sg.js\": \"./node_modules/moment/locale/en-sg.js\",\n\t\"./eo\": \"./node_modules/moment/locale/eo.js\",\n\t\"./eo.js\": \"./node_modules/moment/locale/eo.js\",\n\t\"./es\": \"./node_modules/moment/locale/es.js\",\n\t\"./es-do\": \"./node_modules/moment/locale/es-do.js\",\n\t\"./es-do.js\": \"./node_modules/moment/locale/es-do.js\",\n\t\"./es-mx\": \"./node_modules/moment/locale/es-mx.js\",\n\t\"./es-mx.js\": \"./node_modules/moment/locale/es-mx.js\",\n\t\"./es-us\": \"./node_modules/moment/locale/es-us.js\",\n\t\"./es-us.js\": \"./node_modules/moment/locale/es-us.js\",\n\t\"./es.js\": \"./node_modules/moment/locale/es.js\",\n\t\"./et\": \"./node_modules/moment/locale/et.js\",\n\t\"./et.js\": \"./node_modules/moment/locale/et.js\",\n\t\"./eu\": \"./node_modules/moment/locale/eu.js\",\n\t\"./eu.js\": \"./node_modules/moment/locale/eu.js\",\n\t\"./fa\": \"./node_modules/moment/locale/fa.js\",\n\t\"./fa.js\": \"./node_modules/moment/locale/fa.js\",\n\t\"./fi\": \"./node_modules/moment/locale/fi.js\",\n\t\"./fi.js\": \"./node_modules/moment/locale/fi.js\",\n\t\"./fil\": \"./node_modules/moment/locale/fil.js\",\n\t\"./fil.js\": \"./node_modules/moment/locale/fil.js\",\n\t\"./fo\": \"./node_modules/moment/locale/fo.js\",\n\t\"./fo.js\": \"./node_modules/moment/locale/fo.js\",\n\t\"./fr\": \"./node_modules/moment/locale/fr.js\",\n\t\"./fr-ca\": \"./node_modules/moment/locale/fr-ca.js\",\n\t\"./fr-ca.js\": \"./node_modules/moment/locale/fr-ca.js\",\n\t\"./fr-ch\": \"./node_modules/moment/locale/fr-ch.js\",\n\t\"./fr-ch.js\": \"./node_modules/moment/locale/fr-ch.js\",\n\t\"./fr.js\": \"./node_modules/moment/locale/fr.js\",\n\t\"./fy\": \"./node_modules/moment/locale/fy.js\",\n\t\"./fy.js\": \"./node_modules/moment/locale/fy.js\",\n\t\"./ga\": \"./node_modules/moment/locale/ga.js\",\n\t\"./ga.js\": \"./node_modules/moment/locale/ga.js\",\n\t\"./gd\": \"./node_modules/moment/locale/gd.js\",\n\t\"./gd.js\": \"./node_modules/moment/locale/gd.js\",\n\t\"./gl\": \"./node_modules/moment/locale/gl.js\",\n\t\"./gl.js\": \"./node_modules/moment/locale/gl.js\",\n\t\"./gom-deva\": \"./node_modules/moment/locale/gom-deva.js\",\n\t\"./gom-deva.js\": \"./node_modules/moment/locale/gom-deva.js\",\n\t\"./gom-latn\": \"./node_modules/moment/locale/gom-latn.js\",\n\t\"./gom-latn.js\": \"./node_modules/moment/locale/gom-latn.js\",\n\t\"./gu\": \"./node_modules/moment/locale/gu.js\",\n\t\"./gu.js\": \"./node_modules/moment/locale/gu.js\",\n\t\"./he\": \"./node_modules/moment/locale/he.js\",\n\t\"./he.js\": \"./node_modules/moment/locale/he.js\",\n\t\"./hi\": \"./node_modules/moment/locale/hi.js\",\n\t\"./hi.js\": \"./node_modules/moment/locale/hi.js\",\n\t\"./hr\": \"./node_modules/moment/locale/hr.js\",\n\t\"./hr.js\": \"./node_modules/moment/locale/hr.js\",\n\t\"./hu\": \"./node_modules/moment/locale/hu.js\",\n\t\"./hu.js\": \"./node_modules/moment/locale/hu.js\",\n\t\"./hy-am\": \"./node_modules/moment/locale/hy-am.js\",\n\t\"./hy-am.js\": \"./node_modules/moment/locale/hy-am.js\",\n\t\"./id\": \"./node_modules/moment/locale/id.js\",\n\t\"./id.js\": \"./node_modules/moment/locale/id.js\",\n\t\"./is\": \"./node_modules/moment/locale/is.js\",\n\t\"./is.js\": \"./node_modules/moment/locale/is.js\",\n\t\"./it\": \"./node_modules/moment/locale/it.js\",\n\t\"./it-ch\": \"./node_modules/moment/locale/it-ch.js\",\n\t\"./it-ch.js\": \"./node_modules/moment/locale/it-ch.js\",\n\t\"./it.js\": \"./node_modules/moment/locale/it.js\",\n\t\"./ja\": \"./node_modules/moment/locale/ja.js\",\n\t\"./ja.js\": \"./node_modules/moment/locale/ja.js\",\n\t\"./jv\": \"./node_modules/moment/locale/jv.js\",\n\t\"./jv.js\": \"./node_modules/moment/locale/jv.js\",\n\t\"./ka\": \"./node_modules/moment/locale/ka.js\",\n\t\"./ka.js\": \"./node_modules/moment/locale/ka.js\",\n\t\"./kk\": \"./node_modules/moment/locale/kk.js\",\n\t\"./kk.js\": \"./node_modules/moment/locale/kk.js\",\n\t\"./km\": \"./node_modules/moment/locale/km.js\",\n\t\"./km.js\": \"./node_modules/moment/locale/km.js\",\n\t\"./kn\": \"./node_modules/moment/locale/kn.js\",\n\t\"./kn.js\": \"./node_modules/moment/locale/kn.js\",\n\t\"./ko\": \"./node_modules/moment/locale/ko.js\",\n\t\"./ko.js\": \"./node_modules/moment/locale/ko.js\",\n\t\"./ku\": \"./node_modules/moment/locale/ku.js\",\n\t\"./ku.js\": \"./node_modules/moment/locale/ku.js\",\n\t\"./ky\": \"./node_modules/moment/locale/ky.js\",\n\t\"./ky.js\": \"./node_modules/moment/locale/ky.js\",\n\t\"./lb\": \"./node_modules/moment/locale/lb.js\",\n\t\"./lb.js\": \"./node_modules/moment/locale/lb.js\",\n\t\"./lo\": \"./node_modules/moment/locale/lo.js\",\n\t\"./lo.js\": \"./node_modules/moment/locale/lo.js\",\n\t\"./lt\": \"./node_modules/moment/locale/lt.js\",\n\t\"./lt.js\": \"./node_modules/moment/locale/lt.js\",\n\t\"./lv\": \"./node_modules/moment/locale/lv.js\",\n\t\"./lv.js\": \"./node_modules/moment/locale/lv.js\",\n\t\"./me\": \"./node_modules/moment/locale/me.js\",\n\t\"./me.js\": \"./node_modules/moment/locale/me.js\",\n\t\"./mi\": \"./node_modules/moment/locale/mi.js\",\n\t\"./mi.js\": \"./node_modules/moment/locale/mi.js\",\n\t\"./mk\": \"./node_modules/moment/locale/mk.js\",\n\t\"./mk.js\": \"./node_modules/moment/locale/mk.js\",\n\t\"./ml\": \"./node_modules/moment/locale/ml.js\",\n\t\"./ml.js\": \"./node_modules/moment/locale/ml.js\",\n\t\"./mn\": \"./node_modules/moment/locale/mn.js\",\n\t\"./mn.js\": \"./node_modules/moment/locale/mn.js\",\n\t\"./mr\": \"./node_modules/moment/locale/mr.js\",\n\t\"./mr.js\": \"./node_modules/moment/locale/mr.js\",\n\t\"./ms\": \"./node_modules/moment/locale/ms.js\",\n\t\"./ms-my\": \"./node_modules/moment/locale/ms-my.js\",\n\t\"./ms-my.js\": \"./node_modules/moment/locale/ms-my.js\",\n\t\"./ms.js\": \"./node_modules/moment/locale/ms.js\",\n\t\"./mt\": \"./node_modules/moment/locale/mt.js\",\n\t\"./mt.js\": \"./node_modules/moment/locale/mt.js\",\n\t\"./my\": \"./node_modules/moment/locale/my.js\",\n\t\"./my.js\": \"./node_modules/moment/locale/my.js\",\n\t\"./nb\": \"./node_modules/moment/locale/nb.js\",\n\t\"./nb.js\": \"./node_modules/moment/locale/nb.js\",\n\t\"./ne\": \"./node_modules/moment/locale/ne.js\",\n\t\"./ne.js\": \"./node_modules/moment/locale/ne.js\",\n\t\"./nl\": \"./node_modules/moment/locale/nl.js\",\n\t\"./nl-be\": \"./node_modules/moment/locale/nl-be.js\",\n\t\"./nl-be.js\": \"./node_modules/moment/locale/nl-be.js\",\n\t\"./nl.js\": \"./node_modules/moment/locale/nl.js\",\n\t\"./nn\": \"./node_modules/moment/locale/nn.js\",\n\t\"./nn.js\": \"./node_modules/moment/locale/nn.js\",\n\t\"./oc-lnc\": \"./node_modules/moment/locale/oc-lnc.js\",\n\t\"./oc-lnc.js\": \"./node_modules/moment/locale/oc-lnc.js\",\n\t\"./pa-in\": \"./node_modules/moment/locale/pa-in.js\",\n\t\"./pa-in.js\": \"./node_modules/moment/locale/pa-in.js\",\n\t\"./pl\": \"./node_modules/moment/locale/pl.js\",\n\t\"./pl.js\": \"./node_modules/moment/locale/pl.js\",\n\t\"./pt\": \"./node_modules/moment/locale/pt.js\",\n\t\"./pt-br\": \"./node_modules/moment/locale/pt-br.js\",\n\t\"./pt-br.js\": \"./node_modules/moment/locale/pt-br.js\",\n\t\"./pt.js\": \"./node_modules/moment/locale/pt.js\",\n\t\"./ro\": \"./node_modules/moment/locale/ro.js\",\n\t\"./ro.js\": \"./node_modules/moment/locale/ro.js\",\n\t\"./ru\": \"./node_modules/moment/locale/ru.js\",\n\t\"./ru.js\": \"./node_modules/moment/locale/ru.js\",\n\t\"./sd\": \"./node_modules/moment/locale/sd.js\",\n\t\"./sd.js\": \"./node_modules/moment/locale/sd.js\",\n\t\"./se\": \"./node_modules/moment/locale/se.js\",\n\t\"./se.js\": \"./node_modules/moment/locale/se.js\",\n\t\"./si\": \"./node_modules/moment/locale/si.js\",\n\t\"./si.js\": \"./node_modules/moment/locale/si.js\",\n\t\"./sk\": \"./node_modules/moment/locale/sk.js\",\n\t\"./sk.js\": \"./node_modules/moment/locale/sk.js\",\n\t\"./sl\": \"./node_modules/moment/locale/sl.js\",\n\t\"./sl.js\": \"./node_modules/moment/locale/sl.js\",\n\t\"./sq\": \"./node_modules/moment/locale/sq.js\",\n\t\"./sq.js\": \"./node_modules/moment/locale/sq.js\",\n\t\"./sr\": \"./node_modules/moment/locale/sr.js\",\n\t\"./sr-cyrl\": \"./node_modules/moment/locale/sr-cyrl.js\",\n\t\"./sr-cyrl.js\": \"./node_modules/moment/locale/sr-cyrl.js\",\n\t\"./sr.js\": \"./node_modules/moment/locale/sr.js\",\n\t\"./ss\": \"./node_modules/moment/locale/ss.js\",\n\t\"./ss.js\": \"./node_modules/moment/locale/ss.js\",\n\t\"./sv\": \"./node_modules/moment/locale/sv.js\",\n\t\"./sv.js\": \"./node_modules/moment/locale/sv.js\",\n\t\"./sw\": \"./node_modules/moment/locale/sw.js\",\n\t\"./sw.js\": \"./node_modules/moment/locale/sw.js\",\n\t\"./ta\": \"./node_modules/moment/locale/ta.js\",\n\t\"./ta.js\": \"./node_modules/moment/locale/ta.js\",\n\t\"./te\": \"./node_modules/moment/locale/te.js\",\n\t\"./te.js\": \"./node_modules/moment/locale/te.js\",\n\t\"./tet\": \"./node_modules/moment/locale/tet.js\",\n\t\"./tet.js\": \"./node_modules/moment/locale/tet.js\",\n\t\"./tg\": \"./node_modules/moment/locale/tg.js\",\n\t\"./tg.js\": \"./node_modules/moment/locale/tg.js\",\n\t\"./th\": \"./node_modules/moment/locale/th.js\",\n\t\"./th.js\": \"./node_modules/moment/locale/th.js\",\n\t\"./tk\": \"./node_modules/moment/locale/tk.js\",\n\t\"./tk.js\": \"./node_modules/moment/locale/tk.js\",\n\t\"./tl-ph\": \"./node_modules/moment/locale/tl-ph.js\",\n\t\"./tl-ph.js\": \"./node_modules/moment/locale/tl-ph.js\",\n\t\"./tlh\": \"./node_modules/moment/locale/tlh.js\",\n\t\"./tlh.js\": \"./node_modules/moment/locale/tlh.js\",\n\t\"./tr\": \"./node_modules/moment/locale/tr.js\",\n\t\"./tr.js\": \"./node_modules/moment/locale/tr.js\",\n\t\"./tzl\": \"./node_modules/moment/locale/tzl.js\",\n\t\"./tzl.js\": \"./node_modules/moment/locale/tzl.js\",\n\t\"./tzm\": \"./node_modules/moment/locale/tzm.js\",\n\t\"./tzm-latn\": \"./node_modules/moment/locale/tzm-latn.js\",\n\t\"./tzm-latn.js\": \"./node_modules/moment/locale/tzm-latn.js\",\n\t\"./tzm.js\": \"./node_modules/moment/locale/tzm.js\",\n\t\"./ug-cn\": \"./node_modules/moment/locale/ug-cn.js\",\n\t\"./ug-cn.js\": \"./node_modules/moment/locale/ug-cn.js\",\n\t\"./uk\": \"./node_modules/moment/locale/uk.js\",\n\t\"./uk.js\": \"./node_modules/moment/locale/uk.js\",\n\t\"./ur\": \"./node_modules/moment/locale/ur.js\",\n\t\"./ur.js\": \"./node_modules/moment/locale/ur.js\",\n\t\"./uz\": \"./node_modules/moment/locale/uz.js\",\n\t\"./uz-latn\": \"./node_modules/moment/locale/uz-latn.js\",\n\t\"./uz-latn.js\": \"./node_modules/moment/locale/uz-latn.js\",\n\t\"./uz.js\": \"./node_modules/moment/locale/uz.js\",\n\t\"./vi\": \"./node_modules/moment/locale/vi.js\",\n\t\"./vi.js\": \"./node_modules/moment/locale/vi.js\",\n\t\"./x-pseudo\": \"./node_modules/moment/locale/x-pseudo.js\",\n\t\"./x-pseudo.js\": \"./node_modules/moment/locale/x-pseudo.js\",\n\t\"./yo\": \"./node_modules/moment/locale/yo.js\",\n\t\"./yo.js\": \"./node_modules/moment/locale/yo.js\",\n\t\"./zh-cn\": \"./node_modules/moment/locale/zh-cn.js\",\n\t\"./zh-cn.js\": \"./node_modules/moment/locale/zh-cn.js\",\n\t\"./zh-hk\": \"./node_modules/moment/locale/zh-hk.js\",\n\t\"./zh-hk.js\": \"./node_modules/moment/locale/zh-hk.js\",\n\t\"./zh-mo\": \"./node_modules/moment/locale/zh-mo.js\",\n\t\"./zh-mo.js\": \"./node_modules/moment/locale/zh-mo.js\",\n\t\"./zh-tw\": \"./node_modules/moment/locale/zh-tw.js\",\n\t\"./zh-tw.js\": \"./node_modules/moment/locale/zh-tw.js\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./node_modules/moment/locale sync recursive ^\\\\.\\\\/.*$\";","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"app\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunktemplate_feo_react_babel\"] = self[\"webpackChunktemplate_feo_react_babel\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendor\"], () => (__webpack_require__(\"./src/App.tsx\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":["Decorator","STATE_NAMES","users","chatLogs","exerciseTypes","workouts","recentUserSearches","patientSearch","recentPatientSearches","appointments","appointmentTypes","clinicConfig","providers","appointmentTemplates","patients","API_Config","login","graphQL","patientDemographics","NAVIGATION","appointmentBook","clinicChat","patientRecords","logout","DRAGGABLE","typeUser","fromUserSearch","typePatientSummary","fromPatientSearch","VIEW_NAME","blockedUsers","chatLog","favouriteUsers","userSearch","VIEW_CONTAINER","calendarControl","calendarDetail","PatientSearchSidebarPrefs","id","expandedSize","location","SidebarLocation","left","PatientSearchSidebarContainers","container","SELECT","appointmentType","cLogger","debug","cLoggerDetail","patientQuery","constructor","getInstance","Controller","connectToApplication","restSM","RESTApiStateManager","stateName","serverURL","api","isActive","idField","qlSM","GraphQLApiStateManager","apiURL","apis","findAll","create","destroy","update","find","data","aggregateSM","memorySM","asyncREST","asyncQL","onDocumentLoaded","socketListerDelegate","SocketManager","chatManager","ChatManager","NotificationController","DownloadManager","getStateManager","getListenerName","isLoggedIn","getLoggedInUserId","result","loggedInUser","getLoggedInUsername","handleMessage","getCurrentUser","stateChangedItemAdded","stateChangedItemRemoved","stateChangedItemUpdated","stateChanged","handleShowChat","delete","addExerciseToCurrentWorkout","copyOfExercise","exerciseType","v4","addWorkoutExercisesToCurrentWorkout","workout","exercise","setupDataObjectDefinitions","exerciseTypeDefinition","ObjectDefinitionRegistry","BasicObjectDefinitionFactory","FieldType","name","value","workoutDefinition","exercisesFieldDefinition","KeyType","getServerAPIURL","window","filterResults","durationRegexp","duration1Valid","duration2Valid","duration1Components","duration1","duration2Components","duration2","carry","duration1Seconds","parseInt","duration2Seconds","sumSeconds","duration1Minutes","duration2Minutes","sumMinutes","duration1Hours","duration2Hours","sumHours","time","startTimeHours","Math","startTimeMinutes","appointmentDuration","duration","endTimeHours","endTimeMinutes","timeString","item1","item2","slLogger","handleDataChangedByAnotherUser","message","type","user","stateObj","SecurityManager","DataChangeType","NotificationManager","username","NotificationType","logger","AppointmentTemplateController","dataElements","oldEvent","tempEvent","currentFirstDate","currentLastDate","currentFirstDateDayNumber","getModel","AppointmentTemplateView","AppointmentTemplateFilterView","getIconForAppointmentType","foundIndex","icon","getIconsForEventTemplate","event","getColourForAppointmentType","getColourForAppointmentTemplate","appointment","getEventForAppointmentTemplateForDate","startDate","dayNumber","template","loadDate","computeTimeStringFromStartTimeAndDurationInSeconds","start","moment","end","color","allDay","editable","resource","createdBy","created","modified","provider","getEventForAppointmentTemplate","onPageLoading","results","inst","newValue","AppointmentTemplateDetailModal","getAppointmentTemplateFromEvent","day","_id","datePickerResponsive","medium","controls","touchUi","datetimePickerResponsive","viewElements","popup","range","deleteButton","appointmentTypeEl","appointmentTypeDropdown","providersDropdown","close","isVisible","applyClinicConfig","stepMinute","dragTimeStep","document","display","contentPadding","fullScreen","responsive","width","datepicker","select","startInput","endInput","showRangeLabels","maxTime","onChange","date","args","setupAppointmentTypeDropDown","types","setupProviderDropdown","startCreateAppointmentTemplate","headerText","buttons","text","keyCode","handler","mobiId","appointmentId","colour","createdOn","updatedEvent","free","cssClass","anchor","elm","updateAppointmentTemplate","ev","currentTarget","setupActionButtons","deletedEvent","snackbar","button","action","registerComponent","populateProviders","labelEl","inputEl","enhance","checkboxList","selected","i","checkbox","resources","calendar","getCalender","handleAppointmentTemplateRendering","icons","buffer","options","clickToCreate","dragToCreate","dragToMove","dragToResize","min","showControls","view","invalidateEvent","invalid","schedule","startDay","endDay","startTime","endTime","timeCellStep","timeLabelStep","recurring","repeat","weekDays","title","Object","groupBy","eventcalendar","config","JSON","setupProviders","providersCollection","AppointmentBookView","datePicker","setupDatePicker","dateFormat","dayNamesMin","showWeekNumbers","handleAppointmentRendering","AppointmentController","AppointmentDetailModal","APPOINTMENT_STATUS_ARRIVED","APPOINTMENT_STATUS_READY_FOR_BILLING","APPOINTMENT_STATUS_BILLING_COMPLETE","APPOINTMENT_TYPE_PATIENT_CANCELLED","APPOINTMENT_TYPE_PATIENT_DNA","loadDateFinish","AppointmentFilterView","getIconsForEvent","getColourForAppointment","getEventForAppointment","today","canEdit","description","patientId","isDNA","isCancelled","arrivalTime","readyForBilling","billingItems","isBilled","addTemplateEvents","currentAppointments","appt","templatedAppt","loadDateDayNumber","appointmentsForTheDay","getAppointmentFromEvent","note","_patient","titleInput","descriptionTextarea","patientArrivedButton","patientCancelledButton","patientDNAButton","readyForBillingButton","billingCompleteButton","patientSearchEl","patientSearchDropdown","warningsEl","getInst","startCreateAppointment","mobiscroll5","updateAppointment","warningsText","originalEvent","originalType","originalNote","getPatientWarnings","patientBasicDetails","warning","setupPatientSearchDropDown","patientsCollection","patient","surname","firstname","filter","PatientSearchSidebar","recentSearches","containerId","vLogger","vLoggerDetail","fastSearchInputId","dataLimit","DOMConfig","viewConfig","resultsContainerId","dataSourceId","resultsElementType","resultsElementAttributes","resultsClasses","keyId","keyType","modifiers","normal","inactive","active","detail","containerClasses","textElementType","textElementClasses","quickDelete","buttonClasses","iconClasses","drag","from","PatientSearchView","fastSearchEl","$","getIdForItemInNamedCollection","item","renderDisplayForItemInNamedCollection","containerEl","getModifierForItemInNamedCollection","Modifier","getSecondaryModifierForItemInNamedCollection","eventPatientSelected","ui","label","updateViewForNamedCollection","newState","fastSearchValues","searchValue","source","disabled","minLength","compareItemsForEquality","isSameMongo","itemDeleted","selectedItem","React","ReactDOM","ContextualInformationHelper","setOptions","browserUtil","App","Component","thisEl","chatNavigationItem","bind","handleShowAppointmentBook","handleShowAppointmentTemplates","handleShowPatientRecords","handleShowPatientSearch","localStorage","render","componentDidMount","getElementById","setupNavigationItemHandling","findItemInState","hideAllSideBars","chatSidebar","eventHide","roomName","href","eventShow","chatView","selectChatRoom","countChanged","newCount","innerHTML","addRemoveClasses","addEventListener","templateEl","plugin","log","console","info","theme","themeVariant","element"],"sourceRoot":""}